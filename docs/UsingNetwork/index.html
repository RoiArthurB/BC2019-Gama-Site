<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>UsingNetwork · Test Site</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="A website for testing"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="UsingNetwork · Test Site"/><meta property="og:type" content="website"/><meta property="og:url" content="https://roiarthurb.github.io/BC2019-Gama-Site/"/><meta property="og:description" content="A website for testing"/><meta property="og:image" content="https://roiarthurb.github.io/BC2019-Gama-Site/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://roiarthurb.github.io/BC2019-Gama-Site/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/BC2019-Gama-Site/img/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://roiarthurb.github.io/BC2019-Gama-Site/blog/atom.xml" title="Test Site Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://roiarthurb.github.io/BC2019-Gama-Site/blog/feed.xml" title="Test Site Blog RSS Feed"/><link rel="stylesheet" href="/css/code-block-buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/code-block-buttons.js"></script><link rel="stylesheet" href="/BC2019-Gama-Site/css/main.css"/><script src="/BC2019-Gama-Site/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/BC2019-Gama-Site/"><img class="logo" src="/BC2019-Gama-Site/img/favicon.ico" alt="Test Site"/><h2 class="headerTitleWithLogo">Test Site</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/BC2019-Gama-Site/docs/doc1" target="_self">Docs</a></li><li class=""><a href="/BC2019-Gama-Site/help" target="_self">Help</a></li><li class=""><a href="/BC2019-Gama-Site/blog/" target="_self">Blog</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">UsingNetwork</h1></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="using-network"></a><a href="#using-network" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Using network</h1>
<h2><a class="anchor" aria-hidden="true" id="introduction"></a><a href="#introduction" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h2>
<p>GAMA provides features to allow agents to communicate with other agents (and other applications) through network and to exchange messages of various types (from simple number to agents). To this purpose, the <code>network</code> skill should be used on agents intending to use these capabilities.</p>
<p>Notice that in this communication, roles are asymetric: the simulations should contain a server and some clients to communicate. Message exchanges are made between agents through this server. 3 protocols are supported (TCP, UDP and MQTT):</p>
<ul>
<li><strong>when TCP or UDP protocols are used:</strong> one agent of the simulation is the server and the other ones are the clients.</li>
<li><strong>when the MQTT protocol is used:</strong> all the agents are clients and the server is an external software. A free solution (ActiveMQ) can be freely downloaded from: <a href="http://activemq.apache.org">http://activemq.apache.org</a>.</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="which-protocol-to-use"></a><a href="#which-protocol-to-use" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Which protocol to use ?</h2>
<p>In the GAMA network, 3 kinds of protocol can be used. Each of them has a particular purpose.</p>
<ul>
<li><strong>MQTT</strong>: this is the default protocol that should be used to make agents of various GAMA instances to communicate through a MQTT server (that should be run as an external application, e.g. ActiveMQ that can be downloaded from: <a href="http://activemq.apache.org/">http://activemq.apache.org/</a>),</li>
<li><strong>UDP</strong>: this protocol should be limited to fast (and unsecured) exchanges of small pieces of data from GAMA to an external application (for example, mouse location from a Processing application to GAMA, c.f. model library),</li>
<li><strong>TCP</strong>: this protocol can be used both to communicate between GAMA applications or between GAMA and an external application.</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="disclaimer"></a><a href="#disclaimer" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Disclaimer</h2>
<p><strong>In all the models using any network communication, the server should be launched before the clients.</strong>
As a consequence, when TCP or UDP protocols are used, a model creating a server agent should always be run first. Using MQTT protocol, the external software server should be launched before running any model using it.</p>
<h2><a class="anchor" aria-hidden="true" id="declaring-a-network-species"></a><a href="#declaring-a-network-species" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Declaring a network species</h2>
<p>To create agents able to communicate through a network, their species should have the skill <code>network</code>:</p>
<pre><code class="hljs">species <span class="hljs-symbol">Networking_Client</span> skills: [network] {
   ...
}
</code></pre>
<p>A list exhaustive of the additional attributes and available actions provided by this skill are described here:
<a href="https://github.com/gama-platform/gama/wiki/BuiltInSkills#network">network skill preference page</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="creation-of-a-network-agent"></a><a href="#creation-of-a-network-agent" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Creation of a network agent</h2>
<p>The network agents are created as any other agents, but (in general) at the creation of the agents, the connection is also created, using the <code>connect</code> built-in action:</p>
<pre><code class="hljs">create Networking_Client {
    do connect <span class="hljs-string">to:</span> <span class="hljs-string">"localhost"</span> <span class="hljs-string">protocol:</span> <span class="hljs-string">"tcp_client"</span> <span class="hljs-string">port:</span> <span class="hljs-number">3001</span> <span class="hljs-string">with_name:</span> <span class="hljs-string">"Client"</span>;
}
</code></pre>
<p>Each protocol has its specificities regarding the connection:</p>
<ul>
<li><strong>TCP</strong>:
<ul>
<li><strong>protocol</strong>: the 2 possibles keywords are <code>tcp_server</code> or <code>tcp_client</code>, depending on the wanted role of the agent in the communication.</li>
<li><strong>port</strong>: traditionally the port <code>3001</code> is used.</li>
</ul></li>
<li><strong>UDP</strong>:
<ul>
<li><strong>protocol</strong>: the 2 possibles keywords are <code>udp_server</code> or <code>udp_emitter</code>, depending on the wanted role of the agent in the communication.</li>
<li><strong>port</strong>: traditionally the port <code>9876</code> is used.</li>
</ul></li>
<li><strong>MQTT</strong>:
<ul>
<li><strong>protocol</strong>: MQTT is the default protocol value (if no value is given, MQTT will be used)</li>
</ul></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="sending-messages"></a><a href="#sending-messages" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sending messages</h2>
<p>To send any message, the agent has to use the <code>send</code> action:</p>
<pre><code class="hljs">    <span class="hljs-keyword">do</span> send <span class="hljs-keyword">to</span>: <span class="hljs-string">"send"</span> <span class="hljs-keyword">contents</span>: <span class="hljs-keyword">name</span> + <span class="hljs-string">" "</span> + <span class="hljs-keyword">cycle</span> + <span class="hljs-string">" sent to server"</span>;
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="receiving-messages"></a><a href="#receiving-messages" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Receiving messages</h2>
<p>The messages sent by other agents are received in the <code>mailbox</code> attribute of each agent. So to get its new message, the agent has simply to check whether it has new messages (with action <code>has_more_message()</code> ) and fetch it (that is get it and remove it from the mailing box) with the action <code>fetch_message()</code>.</p>
<pre><code class="hljs">reflex <span class="hljs-keyword">fetch</span> <span class="hljs-keyword">when</span>: has_more_message() { 
    message mess &lt;- fetch_message();
    <span class="hljs-keyword">write</span> <span class="hljs-type">name</span> + " fecth this message: " + mess.contents;   
}
</code></pre>
<p>Alternatively, the <code>mailbox</code> attribute can be directly accessed (notice that the <code>mailbox</code> is a list of messages):</p>
<pre><code class="hljs"><span class="hljs-built_in">ref</span>lex receive {  
    <span class="hljs-keyword">if</span> (length(mailbox) &gt; <span class="hljs-number">0</span>) {
        write mailbox;
    }
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="broadcasting-a-message-to-all-the-agents-members-of-a-given-group"></a><a href="#broadcasting-a-message-to-all-the-agents-members-of-a-given-group" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Broadcasting a message to all the agents members of a given group</h2>
<p>Each time an agent create a connection to another agent as a client, a way to communicate with it is stored in the <code>network_groups</code> attribute.
So an agent can use this attribute to broadcast messages to all the agents with whose it can communicate:</p>
<pre><code class="hljs">reflex broad {
    loop <span class="hljs-built_in">id</span> <span class="hljs-keyword">over</span>: network_groups {
        do send <span class="hljs-keyword">to</span>: <span class="hljs-built_in">id</span> <span class="hljs-built_in">contents</span>: <span class="hljs-string">"I am Server "</span> + <span class="hljs-built_in">name</span> + <span class="hljs-string">" I give order to "</span> + <span class="hljs-built_in">id</span>;
    }
}
</code></pre>
<p>To go further:</p>
<ul>
<li><a href="https://github.com/gama-platform/gama/wiki/BuiltInSkills#network">network skill peference page</a>.</li>
<li>examples model can be found in the GAMA model library, in: <code>Plugin models &gt; Network</code>.</li>
</ul>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#introduction">Introduction</a></li><li><a href="#which-protocol-to-use">Which protocol to use ?</a></li><li><a href="#disclaimer">Disclaimer</a></li><li><a href="#declaring-a-network-species">Declaring a network species</a></li><li><a href="#creation-of-a-network-agent">Creation of a network agent</a></li><li><a href="#sending-messages">Sending messages</a></li><li><a href="#receiving-messages">Receiving messages</a></li><li><a href="#broadcasting-a-message-to-all-the-agents-members-of-a-given-group">Broadcasting a message to all the agents members of a given group</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/BC2019-Gama-Site/" class="nav-home"><img src="/BC2019-Gama-Site/img/favicon.ico" alt="Test Site" width="66" height="58"/></a><div><h5>Docs</h5><a href="/BC2019-Gama-Site/docs/en/doc1.html">Getting Started (or other categories)</a><a href="/BC2019-Gama-Site/docs/en/doc2.html">Guides (or other categories)</a><a href="/BC2019-Gama-Site/docs/en/doc3.html">API Reference (or other categories)</a></div><div><h5>Community</h5><a href="/BC2019-Gama-Site/en/users.html">User Showcase</a><a href="http://stackoverflow.com/questions/tagged/" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://discordapp.com/">Project Chat</a><a href="https://twitter.com/" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="/BC2019-Gama-Site/blog">Blog</a><a href="https://github.com/">GitHub</a><a class="github-button" data-icon="octicon-star" data-count-href="/facebook/docusaurus/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://opensource.facebook.com/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/BC2019-Gama-Site/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2019 GAMA-Platform</section></footer></div></body></html>
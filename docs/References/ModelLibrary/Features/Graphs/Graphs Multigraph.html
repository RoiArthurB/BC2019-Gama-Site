<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>References/ModelLibrary/Features/Graphs/Graphs Multigraph · GAMA-Platform</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="GAMA, modeling made easy"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="References/ModelLibrary/Features/Graphs/Graphs Multigraph · GAMA-Platform"/><meta property="og:type" content="website"/><meta property="og:url" content="https://roiarthurb.github.io/BC2019-Gama-Site/"/><meta property="og:description" content="GAMA, modeling made easy"/><meta property="og:image" content="https://roiarthurb.github.io/BC2019-Gama-Site/resources/images/general/GamaPlatform.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://roiarthurb.github.io/BC2019-Gama-Site/resources/images/general/GamaPlatform.png"/><link rel="shortcut icon" href="/BC2019-Gama-Site/resources/images/general/GamaPlatform.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://roiarthurb.github.io/BC2019-Gama-Site/blog/atom.xml" title="GAMA-Platform Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://roiarthurb.github.io/BC2019-Gama-Site/blog/feed.xml" title="GAMA-Platform Blog RSS Feed"/><link rel="stylesheet" href="/css/code-block-buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/BC2019-Gama-Site/js/code-block-buttons.js"></script><link rel="stylesheet" href="/BC2019-Gama-Site/css/main.css"/><script src="/BC2019-Gama-Site/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/BC2019-Gama-Site/"><img class="logo" src="/BC2019-Gama-Site/resources/images/general/GamaPlatform.png" alt="GAMA-Platform"/><h2 class="headerTitleWithLogo">GAMA-Platform</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a target="_self">Index</a></li><li class=""><a href="/BC2019-Gama-Site/docs/Home" target="_self">Docs</a></li><li class=""><a href="/BC2019-Gama-Site/help" target="_self">Help</a></li><li class=""><a href="/BC2019-Gama-Site/blog/" target="_self">Blog</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">References/ModelLibrary/Features/Graphs/Graphs Multigraph</h1></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="multigraph"></a><a href="#multigraph" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Multigraph</h1>
<p><em>Author : Patrick Taillandier</em></p>
<p>This model shows how to build a graph on which people agents will move with GIS Shapefile, but also to generate an other graph representing the friendship between the people agents, people agents trying to be closer spatially to each other</p>
<p>Code of the model :</p>
<pre><code class="hljs">
model multigraph

global {
    file shape_file_in &lt;- file(<span class="hljs-string">'../includes/road.shp'</span>) ;
    file shape_file_bounds &lt;- file(<span class="hljs-string">'../includes/bounds.shp'</span>) ;
    geometry <span class="hljs-built_in">shape</span> &lt;- envelope(shape_file_bounds);
    
    <span class="hljs-comment">//spatial graph representing the road network</span>
    graph road_graph; 
    
    <span class="hljs-comment">//social graph (not spatial) representing the frienship links between people</span>
    graph friendship_graph &lt;- graph([]);
    
    init {
        create road from: shape_file_in;
        
        <span class="hljs-comment">//creation of th road graph from the road agents</span>
        road_graph &lt;- as_edge_graph(road);
        
        <span class="hljs-comment">//creation of 50 people agent, and add each people agent as a node in the friendship graph</span>
        create people number: <span class="hljs-number">50</span> {
            <span class="hljs-built_in">add</span> node(self) to: friendship_graph;
        }
        
        <span class="hljs-comment">//creation of 50 friendship link between people agents</span>
        <span class="hljs-built_in">loop</span> times: <span class="hljs-number">50</span> {
            people p1 &lt;- one_of(people);
            people p2 &lt;- one_of(list(people) - p1);
            create friendship_link  {
                <span class="hljs-built_in">add</span> edge (p1, p2, self) to: friendship_graph;
                <span class="hljs-built_in">shape</span> &lt;- link(p1,p2);
            }
        }
    }
}

species people skills: [moving]{
    <span class="hljs-built_in">point</span> location &lt;- any_location_in(one_of(road));
    people target_people &lt;- one_of(people);
    <span class="hljs-built_in">point</span> target &lt;- target_people.location;
    <span class="hljs-built_in">float</span> <span class="hljs-built_in">size</span> &lt;- <span class="hljs-number">3.0</span>;
    
    <span class="hljs-comment">//action that make recompute the size of the agents as the distance between it and its target people in the friendship graph (the farthest, the biggest)</span>
    action updateSize {
        path friendship_path &lt;- path_between(friendship_graph,self,target_people);
        <span class="hljs-keyword">if</span> (friendship_path != nil) {
            <span class="hljs-built_in">size</span> &lt;-<span class="hljs-built_in">max</span>([<span class="hljs-number">2</span>,length( friendship_path.edges)]) as <span class="hljs-built_in">float</span>;
        }
    }
    
    <span class="hljs-comment">//the agent moves toward its target, when reaching it, it chooses another target as the location of one of the people agent</span>
    reflex movement {
        <span class="hljs-keyword">if</span> (location distance_to target &lt; <span class="hljs-number">5.0</span>) {
            target_people &lt;- one_of(people);
            target &lt;- target_people.location;
            do updateSize;
        }
        do goto on:road_graph target:target speed:<span class="hljs-number">1</span> + rnd(<span class="hljs-number">2</span>);
    }
    aspect <span class="hljs-keyword">default</span> {
        <span class="hljs-title">draw</span> circle(<span class="hljs-built_in">size</span>) <span class="hljs-built_in">color</span>: #<span class="hljs-built_in">red</span>;
    }   
}
    
species friendship_link {
    
    aspect <span class="hljs-keyword">default</span> {
        <span class="hljs-title">draw</span> <span class="hljs-built_in">shape</span> <span class="hljs-built_in">color</span>: #<span class="hljs-built_in">blue</span>;
    }
}
    
species road  {
    aspect <span class="hljs-keyword">default</span> {
        <span class="hljs-title">draw</span> <span class="hljs-built_in">shape</span> <span class="hljs-built_in">color</span>:#black ;
    }
} 


experiment multigraph type: gui {
    output {
        display friendship type: opengl{
            species road ;
            species friendship_link ;
            species people;
        }
    }
}
</code></pre>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/BC2019-Gama-Site/" class="nav-home"><img src="/BC2019-Gama-Site/resources/images/general/GamaPlatform.png" alt="GAMA-Platform" width="66" height="58"/></a><div><h5>Docs</h5><a href="/BC2019-Gama-Site/docs/en/doc1.html">Getting Started (or other categories)</a><a href="/BC2019-Gama-Site/docs/en/doc2.html">Guides (or other categories)</a><a href="/BC2019-Gama-Site/docs/en/doc3.html">API Reference (or other categories)</a></div><div><h5>Community</h5><a href="/BC2019-Gama-Site/en/users.html">User Showcase</a><a href="http://stackoverflow.com/questions/tagged/" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://discordapp.com/">Project Chat</a><a href="https://twitter.com/" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="/BC2019-Gama-Site/blog">Blog</a><a href="https://github.com/">GitHub</a></div></section><section class="copyright">Copyright © 2019 GAMA-Platform</section></footer></div></body></html>
<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>References/ModelLibrary/Toy Models/Articles/Articles ville_6 · Test Site</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="A website for testing"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="References/ModelLibrary/Toy Models/Articles/Articles ville_6 · Test Site"/><meta property="og:type" content="website"/><meta property="og:url" content="https://roiarthurb.github.io/BC2019-Gama-Site/"/><meta property="og:description" content="A website for testing"/><meta property="og:image" content="https://roiarthurb.github.io/BC2019-Gama-Site/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://roiarthurb.github.io/BC2019-Gama-Site/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/BC2019-Gama-Site/img/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://roiarthurb.github.io/BC2019-Gama-Site/blog/atom.xml" title="Test Site Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://roiarthurb.github.io/BC2019-Gama-Site/blog/feed.xml" title="Test Site Blog RSS Feed"/><link rel="stylesheet" href="/css/code-block-buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/code-block-buttons.js"></script><link rel="stylesheet" href="/BC2019-Gama-Site/css/main.css"/><script src="/BC2019-Gama-Site/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/BC2019-Gama-Site/"><img class="logo" src="/BC2019-Gama-Site/img/favicon.ico" alt="Test Site"/><h2 class="headerTitleWithLogo">Test Site</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/BC2019-Gama-Site/docs/doc1" target="_self">Docs</a></li><li class=""><a href="/BC2019-Gama-Site/help" target="_self">Help</a></li><li class=""><a href="/BC2019-Gama-Site/blog/" target="_self">Blog</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">References/ModelLibrary/Toy Models/Articles/Articles ville_6</h1></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="ville-6"></a><a href="#ville-6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ville 6</h1>
<p>_Author : _</p>
<p>Creation of buildings and roads thanks to a shape file. The color of the building depends on the type of the building, while the color of a house depend on its income. People among the world will try to find the best building according to the mean income of their neighbors and their own income, but also to their working place. This model add a new display showing the &quot;color&quot; of each building according to the mean income of its residents. The buildings also have a z location given thanks to a mnt file.</p>
<p>Code of the model :</p>
<pre><code class="hljs">model ville

<span class="hljs-keyword">global</span> {
    file shape_file_batiments &lt;- file("../includes/batiments.shp");
    file shape_file_routes &lt;- file("../includes/routes.shp");
    file mnt &lt;- file("../includes/mnt.asc");
    file texture &lt;- file(<span class="hljs-string">'../includes/Texture.png'</span>);
    geometry shape &lt;- envelope(mnt);
    graph&lt;<span class="hljs-type">point</span>, route&gt; reseau_route;
    list&lt;batiment&gt; industries;
    
    init {
        <span class="hljs-keyword">create</span> route <span class="hljs-keyword">from</span>: shape_file_routes;
        reseau_route &lt;- as_edge_graph(route);
        <span class="hljs-keyword">create</span> batiment <span class="hljs-keyword">from</span>: shape_file_batiments <span class="hljs-keyword">with</span>: [<span class="hljs-keyword">type</span>:: string(<span class="hljs-keyword">read</span>("NATURE"))] {
            <span class="hljs-type">float</span> z &lt;- (mnt_cell(<span class="hljs-keyword">location</span>)).grid_value;   
            <span class="hljs-keyword">location</span> &lt;- {<span class="hljs-keyword">location</span>.x,<span class="hljs-keyword">location</span>.y,z};
        }
        industries &lt;- batiment <span class="hljs-keyword">select</span> (<span class="hljs-keyword">each</span>.<span class="hljs-keyword">type</span> = "Industrial");
        <span class="hljs-keyword">create</span> foyer number: <span class="hljs-number">500</span>;
    }
}

grid mnt_cell file: mnt;

species foyer {
    <span class="hljs-type">float</span> revenu &lt;- gauss(<span class="hljs-number">1500</span>, <span class="hljs-number">500</span>);
    <span class="hljs-type">bool</span> est_satisfait <span class="hljs-keyword">update</span>: calculer_satisfaction();
    batiment habitation;
    batiment lieu_travail;
    init {
        lieu_travail &lt;- one_of(batiment <span class="hljs-keyword">where</span> (<span class="hljs-keyword">each</span>.<span class="hljs-keyword">type</span> = "Industrial"));
        habitation &lt;- choisir_batiment(); 
        <span class="hljs-keyword">do</span> emmenager;
    }
    <span class="hljs-type">bool</span> calculer_satisfaction {
        list&lt;foyer&gt; voisins &lt;- foyer at_distance <span class="hljs-number">50.0</span>;
        <span class="hljs-type">float</span> revenu_moyen &lt;- mean(voisins collect (<span class="hljs-keyword">each</span>.revenu));
        <span class="hljs-keyword">return</span> empty(voisins) <span class="hljs-keyword">or</span> (revenu_moyen &gt; (revenu * <span class="hljs-number">0.7</span>) <span class="hljs-keyword">and</span> revenu_moyen &lt; (revenu / <span class="hljs-number">0.7</span>));
    }
    action emmenager {
        habitation.capacite &lt;- habitation.capacite - <span class="hljs-number">1</span>;
        <span class="hljs-keyword">location</span> &lt;- any_location_in(habitation.shape) + {<span class="hljs-number">0</span>,<span class="hljs-number">0</span>, (habitation.hauteur + habitation.<span class="hljs-keyword">location</span>.z)};
        habitation.foyers &lt;&lt; self;
    }
    action demenager {
        habitation.capacite &lt;- habitation.capacite + <span class="hljs-number">1</span>;
        remove self <span class="hljs-keyword">from</span>: habitation.foyers;
    }
    batiment choisir_batiment {
        batiment b  &lt;- one_of(batiment <span class="hljs-keyword">where</span> ((<span class="hljs-keyword">each</span>.capacite &gt;<span class="hljs-number">0</span>) <span class="hljs-keyword">and</span> ( <span class="hljs-keyword">each</span>.distances[lieu_travail]&lt; <span class="hljs-number">1000.0</span>)));
        <span class="hljs-keyword">return</span> b;
    }
    reflex demenagement <span class="hljs-keyword">when</span>: !est_satisfait {
        <span class="hljs-keyword">do</span> demenager;
        habitation &lt;- choisir_batiment();
        <span class="hljs-keyword">do</span> emmenager;
    }
    aspect revenu {
        <span class="hljs-type">int</span> val &lt;- <span class="hljs-type">int</span>(<span class="hljs-number">255</span> * (revenu / <span class="hljs-number">3000</span>));
        draw sphere(<span class="hljs-number">5</span>) color: rgb(<span class="hljs-number">255</span> - val, val, <span class="hljs-number">0</span>);
    }
}
species batiment {
    string <span class="hljs-keyword">type</span>;
    <span class="hljs-type">int</span> capacite &lt;- <span class="hljs-keyword">type</span> = "Industrial" ? <span class="hljs-number">0</span> : <span class="hljs-type">int</span>(shape.area / <span class="hljs-number">70.0</span>);
    map&lt;batiment,<span class="hljs-type">float</span>&gt; distances;
    <span class="hljs-type">int</span> hauteur &lt;- <span class="hljs-number">5</span> + rnd(<span class="hljs-number">10</span>);
    list&lt;foyer&gt; foyers ;
    <span class="hljs-type">float</span> revenu_moyen <span class="hljs-keyword">update</span>: empty(foyer) ? <span class="hljs-number">0.0</span> : mean (foyers collect <span class="hljs-keyword">each</span>.revenu);
    init {
        <span class="hljs-keyword">loop</span> bat <span class="hljs-keyword">over</span>: batiment <span class="hljs-keyword">where</span> (<span class="hljs-keyword">each</span>.<span class="hljs-keyword">type</span> = "Industrial") {
            put (topology(reseau_route) distance_between [self,bat]) at: bat <span class="hljs-keyword">in</span>: distances;
        }
    }
    aspect geometrie {
        draw shape color: <span class="hljs-keyword">type</span> = "Industrial" ? #pink : #gray depth: hauteur;
    }
    aspect information_foyer {
        draw shape color: <span class="hljs-keyword">type</span> = "Industrial" ? #pink : (empty(foyers) ? #gray : rgb(<span class="hljs-type">int</span>(<span class="hljs-number">255</span> * (<span class="hljs-number">1</span> - (revenu_moyen / <span class="hljs-number">3000</span>))), <span class="hljs-type">int</span>(<span class="hljs-number">255</span> * (revenu_moyen / <span class="hljs-number">3000</span>)), <span class="hljs-number">0</span>)) depth: length(foyers);
    }
}
species route {
    aspect geometrie {
        draw shape color: #black at:{<span class="hljs-keyword">location</span>.x,<span class="hljs-keyword">location</span>.y,(mnt_cell(<span class="hljs-keyword">location</span>)).grid_value};
    }
}
experiment ville <span class="hljs-keyword">type</span>: gui {
    output {
        display carte_principale <span class="hljs-keyword">type</span>: opengl {
            grid mnt_cell triangulation: <span class="hljs-keyword">true</span> texture:texture elevation:<span class="hljs-keyword">true</span> transparency: <span class="hljs-number">0.3</span>;
            species batiment aspect: geometrie;
            species route aspect: geometrie;
            species foyer aspect: revenu;
        }
        display carte_batiment <span class="hljs-keyword">type</span>: opengl {
            species batiment aspect: information_foyer;
        }
    }
}
</code></pre>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/BC2019-Gama-Site/" class="nav-home"><img src="/BC2019-Gama-Site/img/favicon.ico" alt="Test Site" width="66" height="58"/></a><div><h5>Docs</h5><a href="/BC2019-Gama-Site/docs/en/doc1.html">Getting Started (or other categories)</a><a href="/BC2019-Gama-Site/docs/en/doc2.html">Guides (or other categories)</a><a href="/BC2019-Gama-Site/docs/en/doc3.html">API Reference (or other categories)</a></div><div><h5>Community</h5><a href="/BC2019-Gama-Site/en/users.html">User Showcase</a><a href="http://stackoverflow.com/questions/tagged/" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://discordapp.com/">Project Chat</a><a href="https://twitter.com/" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="/BC2019-Gama-Site/blog">Blog</a><a href="https://github.com/">GitHub</a><a class="github-button" data-icon="octicon-star" data-count-href="/facebook/docusaurus/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://opensource.facebook.com/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/BC2019-Gama-Site/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2019 GAMA-Platform</section></footer></div></body></html>
<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Tutorials/Tutorials/PredatorPrey/PredatorPrey_step12 · Test Site</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;h1&gt;&lt;a class=&quot;anchor&quot; aria-hidden=&quot;true&quot; id=&quot;12-image-loading&quot;&gt;&lt;/a&gt;&lt;a href=&quot;#12-image-loading&quot; aria-hidden=&quot;true&quot; class=&quot;hash-link&quot;&gt;&lt;svg class=&quot;hash-link-icon&quot; aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;12. Image loading&lt;/h1&gt;
"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Tutorials/Tutorials/PredatorPrey/PredatorPrey_step12 · Test Site"/><meta property="og:type" content="website"/><meta property="og:url" content="https://roiarthurb.github.io/BC2019-Gama-Site/"/><meta property="og:description" content="&lt;h1&gt;&lt;a class=&quot;anchor&quot; aria-hidden=&quot;true&quot; id=&quot;12-image-loading&quot;&gt;&lt;/a&gt;&lt;a href=&quot;#12-image-loading&quot; aria-hidden=&quot;true&quot; class=&quot;hash-link&quot;&gt;&lt;svg class=&quot;hash-link-icon&quot; aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;12. Image loading&lt;/h1&gt;
"/><meta property="og:image" content="https://roiarthurb.github.io/BC2019-Gama-Site/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://roiarthurb.github.io/BC2019-Gama-Site/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/BC2019-Gama-Site/img/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://roiarthurb.github.io/BC2019-Gama-Site/blog/atom.xml" title="Test Site Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://roiarthurb.github.io/BC2019-Gama-Site/blog/feed.xml" title="Test Site Blog RSS Feed"/><link rel="stylesheet" href="/css/code-block-buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/code-block-buttons.js"></script><link rel="stylesheet" href="/BC2019-Gama-Site/css/main.css"/><script src="/BC2019-Gama-Site/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/BC2019-Gama-Site/"><img class="logo" src="/BC2019-Gama-Site/img/favicon.ico" alt="Test Site"/><h2 class="headerTitleWithLogo">Test Site</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/BC2019-Gama-Site/docs/doc1" target="_self">Docs</a></li><li class=""><a href="/BC2019-Gama-Site/help" target="_self">Help</a></li><li class=""><a href="/BC2019-Gama-Site/blog/" target="_self">Blog</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Tutorials/Tutorials/PredatorPrey/PredatorPrey_step12</h1></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="12-image-loading"></a><a href="#12-image-loading" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>12. Image loading</h1>
<p>This 12th step illustrates how to load an image file and to use it to initialize a grid.</p>
<h2><a class="anchor" aria-hidden="true" id="formulation"></a><a href="#formulation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Formulation</h2>
<ul>
<li>Building of the initial environment (food and foodProd of the cells) from a image file</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="model-definition"></a><a href="#model-definition" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Model Definition</h2>
<h3><a class="anchor" aria-hidden="true" id="global-variable"></a><a href="#global-variable" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>global variable</h3>
<p>We add a new global variable: the image file:</p>
<pre><code class="hljs">    file map_init &lt;- image_file(<span class="hljs-string">"../images/predator_prey_raster_map.png"</span>)<span class="hljs-comment">;</span>
</code></pre>
<p>The image file is here: <img src="resources/images/tutorials/predator_prey_raster_map.png" alt="images/predator_prey_raster_map.png"></p>
<p>You have to copy it in your project folder: images/</p>
<h3><a class="anchor" aria-hidden="true" id="model-initialization"></a><a href="#model-initialization" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>model initialization</h3>
<p>In order to have a more complex environment, we want to use this image as the initialization of the environment. The food level available in a vegetation_cell will be based on the green level of the corresponding pixel in the image. You will be able to use such process to represent existing real environment in your model.
We modify the global init of the model in order to cast the image file in a matrix. We use for that the <strong>file as_matrix  {nb_cols, nb_lines}</strong> operator that allows to convert a file (image, csv) to a matrix composed of <strong>nb_cols</strong> columns and <strong>nb_lines</strong> lines.</p>
<p>Concerning the manipulation of matrix, it is possible to obtain the element [i,j] of a matrix by using <strong>my_matrix [i,j]</strong>.</p>
<p>A  grid can be view as spatial matrix: each cell of a grid has two built-in variables <strong>grid_x</strong> and <strong>grid_y</strong> that represent the column and line indexes of the cell.</p>
<pre><code class="hljs">  <span class="hljs-attr">init</span> <span class="hljs-string">{</span>
      <span class="hljs-attr">create</span> <span class="hljs-string">prey number: nb_preys_init ;</span>
      <span class="hljs-attr">create</span> <span class="hljs-string">predator number: nb_predators_init ;</span>
      <span class="hljs-attr">matrix</span> <span class="hljs-string">init_data &lt;- map_init as_matrix {50,50};</span>
      <span class="hljs-attr">ask</span> <span class="hljs-string">vegetation_cell {</span>
         <span class="hljs-attr">color</span> <span class="hljs-string">&lt;- rgb (init_data[grid_x,grid_y]) ;</span>
         <span class="hljs-attr">food</span> <span class="hljs-string">&lt;- 1 - ((color as list)[0] / 255) ;</span>
         <span class="hljs-attr">foodProd</span> <span class="hljs-string">&lt;- food / 100 ;</span>
      <span class="hljs-attr">}</span>
   <span class="hljs-attr">}</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="conclusion"></a><a href="#conclusion" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Conclusion</h2>
<p>Congratulations, you have complete your first GAMA models! Now, you have enough knowledge to create many models that includes: dynamic grid-based environment, moving and interacting agents and the needed visualization to make good use of your simulation. Feel free to use this knowledge to create your very own models! Or perhaps you want to continue your study with the more advanced <a href="Tutorials">tutorials</a>?</p>
<h2><a class="anchor" aria-hidden="true" id="complete-model"></a><a href="#complete-model" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Complete Model</h2>
<pre><code class="hljs">model prey_predator

<span class="hljs-keyword">global</span> {
    <span class="hljs-keyword">int</span> nb_preys_init &lt;- <span class="hljs-number">200</span>;
    <span class="hljs-keyword">int</span> nb_predators_init &lt;- <span class="hljs-number">20</span>;
    <span class="hljs-keyword">float</span> prey_max_energy &lt;- <span class="hljs-number">1.0</span>;
    <span class="hljs-keyword">float</span> prey_max_transfert &lt;- <span class="hljs-number">0.1</span> ;
    <span class="hljs-keyword">float</span> prey_energy_consum &lt;- <span class="hljs-number">0.05</span>;
    <span class="hljs-keyword">float</span> predator_max_energy &lt;- <span class="hljs-number">1.0</span>;
    <span class="hljs-keyword">float</span> predator_energy_transfert &lt;- <span class="hljs-number">0.5</span>;
    <span class="hljs-keyword">float</span> predator_energy_consum &lt;- <span class="hljs-number">0.02</span>;
    <span class="hljs-keyword">float</span> prey_proba_reproduce &lt;- <span class="hljs-number">0.01</span>;
    <span class="hljs-keyword">int</span> prey_nb_max_offsprings &lt;- <span class="hljs-number">5</span>; 
    <span class="hljs-keyword">float</span> prey_energy_reproduce &lt;- <span class="hljs-number">0.5</span>; 
    <span class="hljs-keyword">float</span> predator_proba_reproduce &lt;- <span class="hljs-number">0.01</span>;
    <span class="hljs-keyword">int</span> predator_nb_max_offsprings &lt;- <span class="hljs-number">3</span>;
    <span class="hljs-keyword">float</span> predator_energy_reproduce &lt;- <span class="hljs-number">0.5</span>;
    file map_init &lt;- image_file(<span class="hljs-string">"../images/predator_prey_raster_map.png"</span>);
    
    <span class="hljs-keyword">int</span> nb_preys -&gt; {length (prey)};
    <span class="hljs-keyword">int</span> nb_predators -&gt; {length (predator)};
    
    init {
        create prey number: nb_preys_init ; 
        create predator number: nb_predators_init ;
        ask vegetation_cell {
            color &lt;- rgb (map_init at {grid_x,grid_y}) ;
            food &lt;- <span class="hljs-number">1</span> - (((color <span class="hljs-keyword">as</span> <span class="hljs-keyword">list</span>)[<span class="hljs-number">0</span>]) / <span class="hljs-number">255</span>) ;
            foodProd &lt;- food / <span class="hljs-number">100</span> ; 
        }
    }
    
    reflex save_result when: (nb_preys &gt; <span class="hljs-number">0</span>) <span class="hljs-keyword">and</span> (nb_predators &gt; <span class="hljs-number">0</span>){
        save (<span class="hljs-string">"cycle: "</span>+ cycle + <span class="hljs-string">"; nbPreys: "</span> + nb_preys
            + <span class="hljs-string">"; minEnergyPreys: "</span> + ((prey <span class="hljs-keyword">as</span> <span class="hljs-keyword">list</span>) min_of each.energy)
            + <span class="hljs-string">"; maxSizePreys: "</span> + ((prey <span class="hljs-keyword">as</span> <span class="hljs-keyword">list</span>) max_of each.energy) 
            + <span class="hljs-string">"; nbPredators: "</span> + nb_predators           
            + <span class="hljs-string">"; minEnergyPredators: "</span> + ((predator <span class="hljs-keyword">as</span> <span class="hljs-keyword">list</span>) min_of each.energy)          
            + <span class="hljs-string">"; maxSizePredators: "</span> + ((predator <span class="hljs-keyword">as</span> <span class="hljs-keyword">list</span>) max_of each.energy)) 
            to: <span class="hljs-string">"results.txt"</span> type: <span class="hljs-string">"text"</span> ;
    }
    
    reflex stop_simulation when: (nb_preys = <span class="hljs-number">0</span>) <span class="hljs-keyword">or</span> (nb_predators = <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">do</span> halt ;
    } 
}

species generic_species {
    <span class="hljs-keyword">float</span> size &lt;- <span class="hljs-number">1.0</span>;
    rgb color  ;
    <span class="hljs-keyword">float</span> max_energy;
    <span class="hljs-keyword">float</span> max_transfert;
    <span class="hljs-keyword">float</span> energy_consum;
    <span class="hljs-keyword">float</span> proba_reproduce ;
    <span class="hljs-keyword">float</span> nb_max_offsprings;
    <span class="hljs-keyword">float</span> energy_reproduce;
    image_file my_icon;
    vegetation_cell myCell &lt;- one_of (vegetation_cell) ;
    <span class="hljs-keyword">float</span> energy &lt;- (rnd(<span class="hljs-number">1000</span>) / <span class="hljs-number">1000</span>) * max_energy  update: energy - energy_consum max: max_energy ;
    
    init {
        location &lt;- myCell.location;
    }
        
    reflex basic_move {
        myCell &lt;- choose_cell();
        location &lt;- myCell.location; 
    } 
    
    vegetation_cell choose_cell {
        <span class="hljs-keyword">return</span> nil;
    }
        
    reflex <span class="hljs-keyword">die</span> when: energy &lt;= <span class="hljs-number">0</span> {
        <span class="hljs-keyword">do</span> <span class="hljs-keyword">die</span> ;
    }
    
    reflex reproduce when: (energy &gt;= energy_reproduce) <span class="hljs-keyword">and</span> (flip(proba_reproduce)) {
        <span class="hljs-keyword">int</span> nb_offsprings &lt;- <span class="hljs-number">1</span> + rnd(nb_max_offsprings <span class="hljs-number">-1</span>);
        create species(<span class="hljs-keyword">self</span>) number: nb_offsprings {
            myCell &lt;- myself.myCell ;
            location &lt;- myCell.location ;
            energy &lt;- myself.energy / nb_offsprings ;
        }
        energy &lt;- energy / nb_offsprings ;
    }
    
    aspect base {
        draw circle(size) color: color ;
    }
    aspect icon {
        draw my_icon size: <span class="hljs-number">2</span> * size ;
    }
    aspect info {
        draw square(size) color: color ;
        draw string(energy with_precision <span class="hljs-number">2</span>) size: <span class="hljs-number">3</span> color: <span class="hljs-comment">#black ;</span>
    }
}

species prey <span class="hljs-keyword">parent</span>: generic_species {
    rgb color &lt;- <span class="hljs-comment">#blue;</span>
    <span class="hljs-keyword">float</span> max_energy &lt;- prey_max_energy ;
    <span class="hljs-keyword">float</span> max_transfert &lt;- prey_max_transfert ;
    <span class="hljs-keyword">float</span> energy_consum &lt;- prey_energy_consum ;
    <span class="hljs-keyword">float</span> proba_reproduce &lt;- prey_proba_reproduce ;
    <span class="hljs-keyword">int</span> nb_max_offsprings &lt;- prey_nb_max_offsprings ;
    <span class="hljs-keyword">float</span> energy_reproduce &lt;- prey_energy_reproduce ;
    file my_icon &lt;- file(<span class="hljs-string">"../images/predator_prey_sheep.png"</span>) ;
        
    reflex eat when: myCell.food &gt; <span class="hljs-number">0</span> {
        <span class="hljs-keyword">float</span> energy_transfert &lt;- min([max_transfert, myCell.food]) ;
        myCell.food &lt;- myCell.food - energy_transfert ;
        energy &lt;- energy + energy_transfert ;
    }
    
    vegetation_cell choose_cell {
        <span class="hljs-keyword">return</span> (myCell.neighbors) with_max_of (each.food);
    }
}
    
species predator <span class="hljs-keyword">parent</span>: generic_species {
    rgb color &lt;- <span class="hljs-comment">#red ;</span>
    <span class="hljs-keyword">float</span> max_energy &lt;- predator_max_energy ;
    <span class="hljs-keyword">float</span> energy_transfert &lt;- predator_energy_transfert ;
    <span class="hljs-keyword">float</span> energy_consum &lt;- predator_energy_consum ;
    <span class="hljs-keyword">list</span>&lt;prey&gt; reachable_preys update: prey inside (myCell);
    <span class="hljs-keyword">float</span> proba_reproduce &lt;- predator_proba_reproduce ;
    <span class="hljs-keyword">int</span> nb_max_offsprings &lt;- predator_nb_max_offsprings ;
    <span class="hljs-keyword">float</span> energy_reproduce &lt;- predator_energy_reproduce ;
    file my_icon &lt;- file(<span class="hljs-string">"../images/predator_prey_wolf.png"</span>) ;
    
    reflex eat when: ! <span class="hljs-keyword">empty</span>(reachable_preys) {
        ask one_of (reachable_preys) {
            <span class="hljs-keyword">do</span> <span class="hljs-keyword">die</span> ;
        }
        energy &lt;- energy + energy_transfert ;
    }
    
    vegetation_cell choose_cell {
        vegetation_cell myCell_tmp &lt;- shuffle(myCell.neighbors) first_with (!(<span class="hljs-keyword">empty</span> (prey inside (each))));
        <span class="hljs-keyword">if</span> myCell_tmp != nil {
            <span class="hljs-keyword">return</span> myCell_tmp;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> one_of (myCell.neighbors);
        } 
    }
}
    
grid vegetation_cell width: <span class="hljs-number">50</span> height: <span class="hljs-number">50</span> neighbors: <span class="hljs-number">4</span> {
    <span class="hljs-keyword">float</span> maxFood &lt;- <span class="hljs-number">1.0</span> ;
    <span class="hljs-keyword">float</span> foodProd &lt;- (rnd(<span class="hljs-number">1000</span>) / <span class="hljs-number">1000</span>) * <span class="hljs-number">0.01</span> ;
    <span class="hljs-keyword">float</span> food &lt;- (rnd(<span class="hljs-number">1000</span>) / <span class="hljs-number">1000</span>) max: maxFood update: food + foodProd ;
    rgb color &lt;- rgb(<span class="hljs-keyword">int</span>(<span class="hljs-number">255</span> * (<span class="hljs-number">1</span> - food)), <span class="hljs-number">255</span>, <span class="hljs-keyword">int</span>(<span class="hljs-number">255</span> * (<span class="hljs-number">1</span> - food))) update: rgb(<span class="hljs-keyword">int</span>(<span class="hljs-number">255</span> * (<span class="hljs-number">1</span> - food)), <span class="hljs-number">255</span>, <span class="hljs-keyword">int</span>(<span class="hljs-number">255</span> *(<span class="hljs-number">1</span> - food))) ;
    <span class="hljs-keyword">list</span>&lt;vegetation_cell&gt; neighbors  &lt;- (<span class="hljs-keyword">self</span> neighbors_at <span class="hljs-number">2</span>); 
}

experiment prey_predator type: gui {
    parameter <span class="hljs-string">"Initial number of preys: "</span> <span class="hljs-keyword">var</span>: nb_preys_init  min: <span class="hljs-number">0</span> max: <span class="hljs-number">1000</span> category: <span class="hljs-string">"Prey"</span> ;
    parameter <span class="hljs-string">"Prey max energy: "</span> <span class="hljs-keyword">var</span>: prey_max_energy category: <span class="hljs-string">"Prey"</span> ;
    parameter <span class="hljs-string">"Prey max transfert: "</span> <span class="hljs-keyword">var</span>: prey_max_transfert  category: <span class="hljs-string">"Prey"</span> ;
    parameter <span class="hljs-string">"Prey energy consumption: "</span> <span class="hljs-keyword">var</span>: prey_energy_consum  category: <span class="hljs-string">"Prey"</span> ;
    parameter <span class="hljs-string">"Initial number of predators: "</span> <span class="hljs-keyword">var</span>: nb_predators_init  min: <span class="hljs-number">0</span> max: <span class="hljs-number">200</span> category: <span class="hljs-string">"Predator"</span> ;
    parameter <span class="hljs-string">"Predator max energy: "</span> <span class="hljs-keyword">var</span>: predator_max_energy category: <span class="hljs-string">"Predator"</span> ;
    parameter <span class="hljs-string">"Predator energy transfert: "</span> <span class="hljs-keyword">var</span>: predator_energy_transfert  category: <span class="hljs-string">"Predator"</span> ;
    parameter <span class="hljs-string">"Predator energy consumption: "</span> <span class="hljs-keyword">var</span>: predator_energy_consum  category: <span class="hljs-string">"Predator"</span> ;
    parameter <span class="hljs-string">'Prey probability reproduce: '</span> <span class="hljs-keyword">var</span>: prey_proba_reproduce category: <span class="hljs-string">'Prey'</span> ;
    parameter <span class="hljs-string">'Prey nb max offsprings: '</span> <span class="hljs-keyword">var</span>: prey_nb_max_offsprings category: <span class="hljs-string">'Prey'</span> ;
    parameter <span class="hljs-string">'Prey energy reproduce: '</span> <span class="hljs-keyword">var</span>: prey_energy_reproduce category: <span class="hljs-string">'Prey'</span> ;
    parameter <span class="hljs-string">'Predator probability reproduce: '</span> <span class="hljs-keyword">var</span>: predator_proba_reproduce category: <span class="hljs-string">'Predator'</span> ;
    parameter <span class="hljs-string">'Predator nb max offsprings: '</span> <span class="hljs-keyword">var</span>: predator_nb_max_offsprings category: <span class="hljs-string">'Predator'</span> ;
    parameter <span class="hljs-string">'Predator energy reproduce: '</span> <span class="hljs-keyword">var</span>: predator_energy_reproduce category: <span class="hljs-string">'Predator'</span> ;
    
    output {
        display main_display {
            grid vegetation_cell lines: <span class="hljs-comment">#black ;</span>
            species prey aspect: icon ;
            species predator aspect: icon ;
        }
        display info_display {
            grid vegetation_cell lines: <span class="hljs-comment">#black ;</span>
            species prey aspect: info ;
            species predator aspect: info ;
        }
        display Population_information refresh:every(<span class="hljs-number">5</span><span class="hljs-comment">#cycles) {</span>
            chart <span class="hljs-string">"Species evolution"</span> type: series size: {<span class="hljs-number">1</span>,<span class="hljs-number">0.5</span>} position: {<span class="hljs-number">0</span>, <span class="hljs-number">0</span>} {
                data <span class="hljs-string">"number_of_preys"</span> value: nb_preys color: <span class="hljs-comment">#blue ;</span>
                data <span class="hljs-string">"number_of_predator"</span> value: nb_predators color: <span class="hljs-comment">#red ;</span>
            }
            chart <span class="hljs-string">"Prey Energy Distribution"</span> type: histogram background: rgb(<span class="hljs-string">"lightGray"</span>) size: {<span class="hljs-number">0.5</span>,<span class="hljs-number">0.5</span>} position: {<span class="hljs-number">0</span>, <span class="hljs-number">0.5</span>} {
                data <span class="hljs-string">"]0;0.25]"</span> value: prey count (each.energy &lt;= <span class="hljs-number">0.25</span>) color:<span class="hljs-comment">#blue;</span>
                data <span class="hljs-string">"]0.25;0.5]"</span> value: prey count ((each.energy &gt; <span class="hljs-number">0.25</span>) <span class="hljs-keyword">and</span> (each.energy &lt;= <span class="hljs-number">0.5</span>)) color:<span class="hljs-comment">#blue;</span>
                data <span class="hljs-string">"]0.5;0.75]"</span> value: prey count ((each.energy &gt; <span class="hljs-number">0.5</span>) <span class="hljs-keyword">and</span> (each.energy &lt;= <span class="hljs-number">0.75</span>)) color:<span class="hljs-comment">#blue;</span>
                data <span class="hljs-string">"]0.75;1]"</span> value: prey count (each.energy &gt; <span class="hljs-number">0.75</span>) color:<span class="hljs-comment">#blue;</span>
            }
            chart <span class="hljs-string">"Predator Energy Distribution"</span> type: histogram background: rgb(<span class="hljs-string">"lightGray"</span>) size: {<span class="hljs-number">0.5</span>,<span class="hljs-number">0.5</span>} position: {<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>} {
                data <span class="hljs-string">"]0;0.25]"</span> value: predator count (each.energy &lt;= <span class="hljs-number">0.25</span>) color: <span class="hljs-comment">#red ;</span>
                data <span class="hljs-string">"]0.25;0.5]"</span> value: predator count ((each.energy &gt; <span class="hljs-number">0.25</span>) <span class="hljs-keyword">and</span> (each.energy &lt;= <span class="hljs-number">0.5</span>)) color: <span class="hljs-comment">#red ;</span>
                data <span class="hljs-string">"]0.5;0.75]"</span> value: predator count ((each.energy &gt; <span class="hljs-number">0.5</span>) <span class="hljs-keyword">and</span> (each.energy &lt;= <span class="hljs-number">0.75</span>)) color: <span class="hljs-comment">#red ;</span>
                data <span class="hljs-string">"]0.75;1]"</span> value: predator count (each.energy &gt; <span class="hljs-number">0.75</span>) color: <span class="hljs-comment">#red;</span>
            }
        }
        monitor <span class="hljs-string">"Number of preys"</span> value: nb_preys;
        monitor <span class="hljs-string">"Number of predators"</span> value: nb_predators;
    }
}
</code></pre>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#formulation">Formulation</a></li><li><a href="#model-definition">Model Definition</a><ul class="toc-headings"><li><a href="#global-variable">global variable</a></li><li><a href="#model-initialization">model initialization</a></li></ul></li><li><a href="#conclusion">Conclusion</a></li><li><a href="#complete-model">Complete Model</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/BC2019-Gama-Site/" class="nav-home"><img src="/BC2019-Gama-Site/img/favicon.ico" alt="Test Site" width="66" height="58"/></a><div><h5>Docs</h5><a href="/BC2019-Gama-Site/docs/en/doc1.html">Getting Started (or other categories)</a><a href="/BC2019-Gama-Site/docs/en/doc2.html">Guides (or other categories)</a><a href="/BC2019-Gama-Site/docs/en/doc3.html">API Reference (or other categories)</a></div><div><h5>Community</h5><a href="/BC2019-Gama-Site/en/users.html">User Showcase</a><a href="http://stackoverflow.com/questions/tagged/" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://discordapp.com/">Project Chat</a><a href="https://twitter.com/" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="/BC2019-Gama-Site/blog">Blog</a><a href="https://github.com/">GitHub</a><a class="github-button" data-icon="octicon-star" data-count-href="/facebook/docusaurus/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://opensource.facebook.com/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/BC2019-Gama-Site/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2019 GAMA-Platform</section></footer></div></body></html>
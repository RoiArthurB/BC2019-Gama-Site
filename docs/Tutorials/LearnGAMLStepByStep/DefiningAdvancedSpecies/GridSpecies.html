<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Tutorials/LearnGAMLStepByStep/DefiningAdvancedSpecies/GridSpecies · Test Site</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="A website for testing"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Tutorials/LearnGAMLStepByStep/DefiningAdvancedSpecies/GridSpecies · Test Site"/><meta property="og:type" content="website"/><meta property="og:url" content="https://roiarthurb.github.io/BC2019-Gama-Site/"/><meta property="og:description" content="A website for testing"/><meta property="og:image" content="https://roiarthurb.github.io/BC2019-Gama-Site/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://roiarthurb.github.io/BC2019-Gama-Site/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/BC2019-Gama-Site/img/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://roiarthurb.github.io/BC2019-Gama-Site/blog/atom.xml" title="Test Site Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://roiarthurb.github.io/BC2019-Gama-Site/blog/feed.xml" title="Test Site Blog RSS Feed"/><link rel="stylesheet" href="/css/code-block-buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/code-block-buttons.js"></script><link rel="stylesheet" href="/BC2019-Gama-Site/css/main.css"/><script src="/BC2019-Gama-Site/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/BC2019-Gama-Site/"><img class="logo" src="/BC2019-Gama-Site/img/favicon.ico" alt="Test Site"/><h2 class="headerTitleWithLogo">Test Site</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/BC2019-Gama-Site/docs/doc1" target="_self">Docs</a></li><li class=""><a href="/BC2019-Gama-Site/help" target="_self">Help</a></li><li class=""><a href="/BC2019-Gama-Site/blog/" target="_self">Blog</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Tutorials/LearnGAMLStepByStep/DefiningAdvancedSpecies/GridSpecies</h1></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="grid-species"></a><a href="#grid-species" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Grid Species</h1>
<p>A grid is a particular species of agents. Indeed, a grid is a set of agents that share a grid topology (until now, we only saw species with continuous topology). As other agents, a grid species can have attributes, attributes, behaviors, aspects
However, contrary to regular species, grid agents are created automatically at the beginning of the simulation. It is thus not necessary to use the create statement to create them.
Moreover, in addition to classic built-in variables, grid a provided with a set of additional built-in variables.</p>
<h2><a class="anchor" aria-hidden="true" id="index"></a><a href="#index" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Index</h2>
<ul>
<li><a href="#declaration">Declaration</a></li>
<li><a href="#built-in-attributes">Built-in attributes</a></li>
<li><a href="#access-to-cells">Access to cells</a></li>
<li><a href="#display-grid">Display grid</a></li>
<li><a href="#grid-with-matrix">Grid with matrix</a></li>
<li><a href="#example">Example</a></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="declaration"></a><a href="#declaration" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Declaration</h2>
<p>Instead of using the <code>species</code> keyword, use the keyword <code>grid</code> to declare a grid species. The grid species has exactly the same facets of the regular species, plus some others.
To declare a grid, you have to specify the number of columns and rows first. You can do it two different ways:</p>
<p>Using the two facets <code>width:</code> and <code>height:</code> to fix the number of cells (the size of each cells will be determined thanks to the environment dimension).</p>
<pre><code class="hljs"><span class="hljs-built_in">grid</span> my_grid <span class="hljs-built_in">width</span>:<span class="hljs-number">8</span> <span class="hljs-built_in">height</span>:<span class="hljs-number">10</span> {
// my_grid has <span class="hljs-number">8</span> <span class="hljs-built_in">columns</span> <span class="hljs-keyword">and</span> <span class="hljs-number">10</span> rows
}
</code></pre>
<p>Using the two facets <code>cell_width:</code> and <code>cell_height:</code> to fix the size of each cells (the number cells will be determined thanks to the environment dimension).</p>
<pre><code class="hljs"><span class="hljs-built_in">grid</span> my_grid cell_width:<span class="hljs-number">3</span> cell_height:<span class="hljs-number">2</span> {
// my_grid has cells with <span class="hljs-built_in">dimension</span> 3m <span class="hljs-built_in">width</span> by 2m <span class="hljs-built_in">height</span>
}
</code></pre>
<p>By default, a grid is composed by 100 rows and 100 columns.</p>
<p>Another facet exists for grid only, very useful. It is the <code>neighbors</code> facet, used to determine how many neighbors has each cell. You can choose among 3 values: 4 (Von Neumann), 6 (hexagon) or 8 (Moore).</p>
<p><img src="resources/images/definingAdvancedSpecies/grid_neighbors.png" alt="images/grid_neighbors.png"></p>
<p>A grid can also be provided with specific facets that allows to optimize the computation time and the memory space, such as <code>use_regular_agents</code>, <code>use_indivitual_shapes</code> and <code>use_neighbors_cache</code>. Please refer to the GAML Reference for more explanation about those particular facets.</p>
<h2><a class="anchor" aria-hidden="true" id="built-in-attributes"></a><a href="#built-in-attributes" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Built-in attributes</h2>
<h3><a class="anchor" aria-hidden="true" id="grid-_x"></a><a href="#grid-_x" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>grid_x</h3>
<p>This variable stores the column index of a cell.</p>
<pre><code class="hljs">   <span class="hljs-built_in">grid</span> cell <span class="hljs-built_in">width</span>: <span class="hljs-number">10</span> <span class="hljs-built_in">height</span>: <span class="hljs-number">10</span> <span class="hljs-built_in">neighbors</span>: <span class="hljs-number">4</span> {
        init {
             write <span class="hljs-string">"my column index is:"</span> + grid_x;
        }
   }
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="grid-_y"></a><a href="#grid-_y" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>grid_y</h3>
<p>This variable stores the row index of a cell.</p>
<pre><code class="hljs">   <span class="hljs-built_in">grid</span> cell <span class="hljs-built_in">width</span>: <span class="hljs-number">10</span> <span class="hljs-built_in">height</span>: <span class="hljs-number">10</span> <span class="hljs-built_in">neighbors</span>: <span class="hljs-number">4</span> {
        init {
             write <span class="hljs-string">"my row index is:"</span> + grid_y;
        }
   }
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="agents"></a><a href="#agents" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>agents</h3>
<p>return the set of agents located inside the cell. Note the use of this variable is deprecated.
It is preferable to use the <code>inside</code> operator:
<a href="#" title="startConcept|grid">//</a>: # (keyword|operator_inside)</p>
<pre><code class="hljs"> grid cell width: <span class="hljs-number">10</span> height: <span class="hljs-number">10</span> neighbors: <span class="hljs-number">4</span> { 
        list&lt;<span class="hljs-keyword">bug&gt; </span><span class="hljs-keyword">bugs_inside </span>-&gt; {<span class="hljs-keyword">bug </span><span class="hljs-keyword">inside </span>self}<span class="hljs-comment">;</span>
   }
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="color"></a><a href="#color" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>color</h3>
<p>The <strong>color</strong> built-in variable is used by the optimized grid display. Indeed, it is possible to use for grid agents an optimized aspect by using in a display the <strong>grid</strong> keyword. In this case, the grid will be displayed using the color defined by the <strong>color</strong> variable. The border of the cells can be displayed with a specific color by using the <strong>lines</strong> facet.</p>
<p>Here an example of the display of a grid species named <strong>cell</strong> with black border.</p>
<pre><code class="hljs"><span class="hljs-attribute">experiment</span> main_xp type: gui{
    <span class="hljs-section">output</span> {
        <span class="hljs-attribute">display</span> map {
            <span class="hljs-attribute">grid</span> cell lines: rgb(<span class="hljs-string">"black"</span>) ;
        }
    }
}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="neighbors"></a><a href="#neighbors" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>neighbors</h3>
<p>The <strong>neighbors</strong> built-in variable returns the list of cells at a distance of 1.</p>
<pre><code class="hljs"><span class="hljs-attribute">grid</span> my_grid {
  <span class="hljs-attribute">reflex</span> writeNeighbors {
    <span class="hljs-attribute">write</span> neighbors;
  }
}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="grid-_value"></a><a href="#grid-_value" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>grid_value</h3>
<p>The <strong>grid_value</strong> built-in variable is used when initializing a grid from grid file (see later). It is also used for the 3D representation of DEM.</p>
<h2><a class="anchor" aria-hidden="true" id="access-to-a-cell"></a><a href="#access-to-a-cell" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Access to a cell</h2>
<p>there are several ways to access to a specific cell:</p>
<ul>
<li>by a location: by casting a location to a cell (the unity (<code>#m</code>, <code>#cm</code>, etc...) is defined when you choose your environment size, in the <a href="GlobalSpecies">global species</a>.</li>
</ul>
<pre><code class="hljs">   global {
         init {
             write <span class="hljs-string">"cell at {57.5, 45} :"</span> + cell({<span class="hljs-number">57.5</span>, <span class="hljs-number">45</span>});
         }
   }

   grid cell width: <span class="hljs-number">10</span> height: <span class="hljs-number">10</span> neighbors: <span class="hljs-number">4</span> {
   }
</code></pre>
<ul>
<li>by the row and column indexes: like matrix, it is possible to directly access to a cell from its indexes</li>
</ul>
<pre><code class="hljs">   global {
         init {
             write <span class="hljs-string">"cell [5,8] :"</span> + cell[<span class="hljs-number">5</span>,<span class="hljs-number">8</span>];
         }
   }
   grid cell width: <span class="hljs-number">10</span> height: <span class="hljs-number">10</span> neighbors: <span class="hljs-number">4</span> {
   }
</code></pre>
<p>The operator <code>grid_at</code> also exists to get a particular cell. You just have to specify the index of the cell you want (in x and y):</p>
<pre><code class="hljs">   global {
         init {
             agent cellAgent &lt;- cell grid_at {<span class="hljs-number">5</span>,<span class="hljs-number">8</span>};
             write <span class="hljs-string">"cell [5,8] :"</span> + cellAgent;
         }
   }
   grid cell width: <span class="hljs-number">10</span> height: <span class="hljs-number">10</span> neighbors: <span class="hljs-number">4</span> {
   }
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="display-grid"></a><a href="#display-grid" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Display Grid</h2>
<p>You can easily display your grid in your experiment as followed :</p>
<pre><code class="hljs"><span class="hljs-title">experiment</span> <span class="hljs-type">MyExperiment</span> <span class="hljs-keyword">type</span>: gui {
    output {
        display <span class="hljs-type">MyDisplay</span> type: opengl {
            grid <span class="hljs-type">MyGrid</span>;
        }
    }
}
</code></pre>
<p>The grid will be displayed, using the color you defined for each cell (with the &quot;color&quot; built-in attribute). You can also show border of each cell by using the facet &quot;lines:&quot; and choosing a rgb color:</p>
<pre><code class="hljs">grid MyGrid <span class="hljs-keyword">lines</span>:<span class="hljs-meta">#black;</span>
</code></pre>
<p>An other way to display a grid will be to define an aspect in your grid agent (the same way as for a <a href="RegularSpecies">regular species</a>), and define your grid as a regular species then in your experiment, choosing your aspect :</p>
<pre><code class="hljs"><span class="hljs-attribute">grid</span> MyGrid {
    <span class="hljs-attribute">aspect</span> firstAspect {
        <span class="hljs-attribute">draw</span> square(<span class="hljs-number">1</span>);
    }
    <span class="hljs-attribute">aspect</span> secondAspect {
        <span class="hljs-attribute">draw</span> circle(<span class="hljs-number">1</span>);
    }
}

<span class="hljs-attribute">experiment</span> MyExperiment type: gui {
    <span class="hljs-section">output</span> {
        <span class="hljs-attribute">display</span> MyDisplay type: opengl {
            <span class="hljs-attribute">species</span> MyGrid aspect:firstAspect;
        }
    }
}
</code></pre>
<p>Beware : don't use this second display when you have large grids : it's much slower.</p>
<h2><a class="anchor" aria-hidden="true" id="grid-from-a-matrix"></a><a href="#grid-from-a-matrix" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Grid from a matrix</h2>
<p>An easy way to load some values in a grid is to use matrix data. A <code>matrix</code> is a type of container (we invite you to learn some more about this useful type <a href="DataTypes#matrix">here</a>). Once you have declared your matrix, you can set the values of your cells using the <code>ask</code> statement :</p>
<pre><code class="hljs">global {
  init {
    matrix data &lt;- matrix([[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">0</span>]]);
    ask cell {
      grid_value &lt;- <span class="hljs-built_in">float</span>(data[grid_x, grid_y]);
    } 
  }
}
</code></pre>
<p>Declaring larger matrix in GAML can be boring as you can imagine. You can load your matrix directly from a csv file with the operator <code>matrix</code> (used for the contruction of the matrix).</p>
<pre><code class="hljs">file my_file &lt;- csv_file(<span class="hljs-string">"path/file.csv"</span>,<span class="hljs-string">"separator"</span>)<span class="hljs-comment">;</span>
matrix my_matrix &lt;- matrix(<span class="hljs-name">my_file</span>)<span class="hljs-comment">;</span>
</code></pre>
<p>You can try to read the following csv :</p>
<pre><code class="hljs"><span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>
<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>
<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>
<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>
<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>
<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>
<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>
<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>
</code></pre>
<p>With the following model :</p>
<pre><code class="hljs"><span class="hljs-attribute">model</span> import_csv

global {
  <span class="hljs-attribute">file</span> my_csv_file &lt;- csv_file(<span class="hljs-string">"../includes/test.csv"</span>,<span class="hljs-string">","</span>);
  <span class="hljs-section">init</span> {
    <span class="hljs-attribute">matrix</span> data &lt;- matrix(my_csv_file);
    <span class="hljs-attribute">ask</span> my_gama_grid {
      <span class="hljs-attribute">grid_value</span> &lt;- float(data[grid_x,grid_y]);
      <span class="hljs-attribute">write</span> data[grid_x,grid_y];
    }
  }
}

<span class="hljs-attribute">grid</span> my_gama_grid width: <span class="hljs-number">11</span> height: <span class="hljs-number">8</span> {
  <span class="hljs-attribute">reflex</span> update_color {
    <span class="hljs-attribute">write</span> grid_value;
    <span class="hljs-attribute">color</span> &lt;- (grid_value = <span class="hljs-number">1</span>) ? <span class="hljs-comment">#blue : #white;</span>
  }
}

experiment main type: gui{
  <span class="hljs-section">output</span> {
    <span class="hljs-attribute">display</span> display_grid {
      <span class="hljs-attribute">grid</span> my_gama_grid;
    }
  }
}
</code></pre>
<p>For more complicated models, you can read some other files, such as ASCII files (asc), DEM files...</p>
<h2><a class="anchor" aria-hidden="true" id="example"></a><a href="#example" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h2>
<p>To practice a bit those notions, we will build a quick model. A &quot;regular&quot; species will move randomly on the environment. A grid is displayed, and its cells becomes red when an instance of the regular species is waking inside this cell, and yellow when the regular agent is in the surrounding of this cell. If no regular agent is on the surrounding, the cell turns green.</p>
<p><img src="resources/images/definingAdvancedSpecies/my_grid_model.png" alt="images/my_grid_model.png"></p>
<p>Here is an example of implementation:</p>
<pre><code class="hljs"><span class="hljs-attr">model</span> <span class="hljs-string">my_grid_model</span>

<span class="hljs-attr">global{</span>
    <span class="hljs-attr">float</span> <span class="hljs-string">max_range &lt;- 5.0;</span>
    <span class="hljs-attr">int</span> <span class="hljs-string">number_of_agents &lt;- 5;</span>
    <span class="hljs-attr">init</span> <span class="hljs-string">{</span>
        <span class="hljs-attr">create</span> <span class="hljs-string">my_species number:number_of_agents;</span>
    <span class="hljs-attr">}</span>
    <span class="hljs-attr">reflex</span> <span class="hljs-string">update {</span>
        <span class="hljs-attr">ask</span> <span class="hljs-string">my_species {</span>
            <span class="hljs-attr">do</span> <span class="hljs-string">wander amplitude:180;    </span>
            <span class="hljs-attr">ask</span> <span class="hljs-string">my_grid at_distance(max_range)</span>
            <span class="hljs-attr">{</span>
                <span class="hljs-meta">if(self</span> <span class="hljs-string">overlaps myself)</span>
                <span class="hljs-attr">{</span>
                    <span class="hljs-meta">self.color_value</span> <span class="hljs-string">&lt;- 2;</span>
                <span class="hljs-attr">}</span>
                <span class="hljs-attr">else</span> <span class="hljs-string">if (self.color_value != 2)</span>
                <span class="hljs-attr">{</span>
                    <span class="hljs-meta">self.color_value</span> <span class="hljs-string">&lt;- 1;</span>
                <span class="hljs-attr">}</span>
            <span class="hljs-attr">}</span>
        <span class="hljs-attr">}</span>
        <span class="hljs-attr">ask</span> <span class="hljs-string">my_grid {</span>
            <span class="hljs-attr">do</span> <span class="hljs-string">update_color;</span>
        <span class="hljs-meta">}</span>   <span class="hljs-string"></span>
    <span class="hljs-attr">}</span>
<span class="hljs-attr">}</span>

<span class="hljs-attr">species</span> <span class="hljs-string">my_species skills:[moving] {</span>
    <span class="hljs-attr">float</span> <span class="hljs-string">speed &lt;- 2.0;</span>
    <span class="hljs-attr">aspect</span> <span class="hljs-string">default {</span>
        <span class="hljs-attr">draw</span> <span class="hljs-string">circle(1) color:#blue;</span>
    <span class="hljs-attr">}</span>
<span class="hljs-attr">}</span>

<span class="hljs-attr">grid</span> <span class="hljs-string">my_grid width:30 height:30 {</span>
    <span class="hljs-attr">int</span> <span class="hljs-string">color_value &lt;- 0;</span>
    <span class="hljs-attr">action</span> <span class="hljs-string">update_color {</span>
        <span class="hljs-attr">if</span> <span class="hljs-string">(color_value = 0) {</span>
            <span class="hljs-attr">color</span> <span class="hljs-string">&lt;- #green;</span>
        <span class="hljs-attr">}</span>
        <span class="hljs-attr">else</span> <span class="hljs-string">if (color_value = 1) {</span>
            <span class="hljs-attr">color</span> <span class="hljs-string">&lt;- #yellow;</span>
        <span class="hljs-attr">}</span>
        <span class="hljs-attr">else</span> <span class="hljs-string">if (color_value = 2) {</span>
            <span class="hljs-attr">color</span> <span class="hljs-string">&lt;- #red;</span>
        <span class="hljs-attr">}</span>
        <span class="hljs-attr">color_value</span> <span class="hljs-string">&lt;- 0;</span>
    <span class="hljs-attr">}</span>
<span class="hljs-attr">}</span>

<span class="hljs-attr">experiment</span> <span class="hljs-string">MyExperiment type: gui {</span>
    <span class="hljs-attr">output</span> <span class="hljs-string">{</span>
        <span class="hljs-attr">display</span> <span class="hljs-string">MyDisplay type: java2D {</span>
            <span class="hljs-attr">grid</span> <span class="hljs-string">my_grid lines:#black;</span>
            <span class="hljs-attr">species</span> <span class="hljs-string">my_species aspect:default; </span>
        <span class="hljs-attr">}</span>
    <span class="hljs-attr">}</span>
<span class="hljs-attr">}</span>
</code></pre>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#index">Index</a></li><li><a href="#declaration">Declaration</a></li><li><a href="#built-in-attributes">Built-in attributes</a><ul class="toc-headings"><li><a href="#grid-_x">grid_x</a></li><li><a href="#grid-_y">grid_y</a></li><li><a href="#agents">agents</a></li><li><a href="#color">color</a></li><li><a href="#neighbors">neighbors</a></li><li><a href="#grid-_value">grid_value</a></li></ul></li><li><a href="#access-to-a-cell">Access to a cell</a></li><li><a href="#display-grid">Display Grid</a></li><li><a href="#grid-from-a-matrix">Grid from a matrix</a></li><li><a href="#example">Example</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/BC2019-Gama-Site/" class="nav-home"><img src="/BC2019-Gama-Site/img/favicon.ico" alt="Test Site" width="66" height="58"/></a><div><h5>Docs</h5><a href="/BC2019-Gama-Site/docs/en/doc1.html">Getting Started (or other categories)</a><a href="/BC2019-Gama-Site/docs/en/doc2.html">Guides (or other categories)</a><a href="/BC2019-Gama-Site/docs/en/doc3.html">API Reference (or other categories)</a></div><div><h5>Community</h5><a href="/BC2019-Gama-Site/en/users.html">User Showcase</a><a href="http://stackoverflow.com/questions/tagged/" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://discordapp.com/">Project Chat</a><a href="https://twitter.com/" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="/BC2019-Gama-Site/blog">Blog</a><a href="https://github.com/">GitHub</a><a class="github-button" data-icon="octicon-star" data-count-href="/facebook/docusaurus/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://opensource.facebook.com/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/BC2019-Gama-Site/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2019 GAMA-Platform</section></footer></div></body></html>
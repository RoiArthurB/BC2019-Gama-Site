<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Charts Ant Foraging (Charts examples) · GAMA-Platform</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="GAMA, modeling made easy"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Charts Ant Foraging (Charts examples) · GAMA-Platform"/><meta property="og:type" content="website"/><meta property="og:url" content="https://roiarthurb.github.io/BC2019-Gama-Site/"/><meta property="og:description" content="GAMA, modeling made easy"/><meta property="og:image" content="https://roiarthurb.github.io/BC2019-Gama-Site/resources/images/general/GamaPlatform.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://roiarthurb.github.io/BC2019-Gama-Site/resources/images/general/GamaPlatform.png"/><link rel="shortcut icon" href="/BC2019-Gama-Site/resources/images/general/GamaPlatform.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://roiarthurb.github.io/BC2019-Gama-Site/blog/atom.xml" title="GAMA-Platform Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://roiarthurb.github.io/BC2019-Gama-Site/blog/feed.xml" title="GAMA-Platform Blog RSS Feed"/><link rel="stylesheet" href="/css/code-block-buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js" async=""></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js" async=""></script><script type="text/javascript" src="/BC2019-Gama-Site/js/code-block-buttons.js" async=""></script><link rel="stylesheet" href="/BC2019-Gama-Site/css/main.css"/><script src="/BC2019-Gama-Site/js/codetabs.js"></script></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/BC2019-Gama-Site/"><img class="logo" src="/BC2019-Gama-Site/resources/images/general/GamaPlatform.png" alt="GAMA-Platform"/><h2 class="headerTitleWithLogo">GAMA-Platform</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/BC2019-Gama-Site/docs/Home" target="_self">Docs</a></li><li class=""><a href="/BC2019-Gama-Site/help" target="_self">Help</a></li><li class=""><a href="/BC2019-Gama-Site/blog/" target="_self">Blog</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Charts Ant Foraging (Charts examples)</h1></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="ant-foraging-charts-examples"></a><a href="#ant-foraging-charts-examples" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ant Foraging (Charts examples)</h1>
<p>_Author : _</p>
<p>Toy Model ant using the question of how ants search food and use pheromons to return to their nest once they did find food. In this model, the charts are particularly used.</p>
<p>Code of the model :</p>
<pre><code class="hljs">model ants

global {
    //Number of ants
    int ants_number &lt;- 100 min: 1 max: 2000 ;
    //Evaporation value per cycle for the pheromons
    float evaporation_per_cycle &lt;- 5.0 min: 0.0 max: 240.0 ;
    //Diffusion rate for the pheromons
    float diffusion_rate &lt;- 1.0 min: 0.0 max: 1.0 ;
    bool use_icons &lt;- true ;
    bool display_state &lt;- true;
    //Size of the grid
    int gridsize &lt;- 75 ;
    //Center of the grid to put the location of the nest
    point center const: true &lt;- { (gridsize / 2),  (gridsize / 2)} ;
    file types const: true &lt;- (pgm_file('../images/environment75x75.pgm')) ;
    string ant_shape_empty const: true &lt;- '../icons/ant.png' ;
    string ant_shape_full const: true &lt;- '../icons/full_ant.png'  ;
    rgb C00CC00 const: true &lt;- rgb('#00CC00') ;    
    rgb C009900 const: true &lt;- rgb('#009900') ; 
    rgb C005500 const: true &lt;- rgb('#005500') ; 
    int food_gathered &lt;- 0 ;   
    geometry shape &lt;- square(gridsize);
    init{  
        //Ant are placed randomly in the nest
        create ant number: ants_number with: [location::any_location_in (ant_grid(center))] ;
    }
    
    //Reflex to diffuse the road of pheromon on the grid
    reflex diffuse {
      diffuse var:road on:ant_grid proportion: diffusion_rate radius:2 propagation: gradient;
   }



}

//Grid to discretize space for the food and the nest
grid ant_grid width: gridsize height: gridsize neighbors: 8 use_regular_agents: false {
    bool multiagent &lt;- true ;
    float road &lt;- 0.0 max:240.0 update: (road&lt;=evaporation_per_cycle) ? 0.0 : road-evaporation_per_cycle;
    int type &lt;- int(types at {grid_x,grid_y}) ;
    bool isNestLocation &lt;- (self distance_to center) &lt; 4 ; 
    bool isFoodLocation &lt;- type = 2 ; 
    rgb color &lt;- isNestLocation ? °violet:((food &gt; 0)? °blue : ((road &lt; 0.001)? rgb ([100,100,100]) : ((road &gt; 2)? °white : ((road &gt; 0.5)? (C00CC00) : ((road &gt; 0.2)? (C009900) : (C005500)))))) update: isNestLocation ? °violet:((food &gt; 0)? °blue : ((road &lt; 0.001)? rgb ([100,100,100]) : ((road &gt; 2)? °white : ((road &gt; 0.5)? (C00CC00) : ((road &gt; 0.2)? (C009900) : (C005500)))))) ;
    int food &lt;- isFoodLocation ? 5 : 0 ;
    int nest const: true &lt;- 300 - int(self distance_to center) ;
    
}
//Species ant that will move and follow a final state machine
species ant skills: [moving] control: fsm {
    float speed &lt;- 2.0 ;
    ant_grid place update: ant_grid (location ); 
    string im &lt;- 'ant_shape_empty' ;
    bool hasFood &lt;- false ;



    reflex diffuse_road when:hasFood=true{
      ant_grid(location).road &lt;- ant_grid(location).road + 100.0;
   }
   //Action to pick food
    action pick {
        im &lt;- ant_shape_full ;
        hasFood &lt;- true ;
        place.food &lt;- place.food - 1 ;
    }
    //Action to drop food
    action drop {
        food_gathered &lt;- food_gathered + 1 ;
        hasFood &lt;- false ;
        heading &lt;- heading - 180 ;
    }
    //Action to chose the best place according to the possible food in the neighbor cells
    action choose_best_place type: ant_grid {
        list&lt;ant_grid&gt; list_places &lt;- place.neighbors ;
        if (list_places count (each.food &gt; 0)) &gt; 0  {
            return (list_places first_with (each.food &gt; 0)) ;
        } else {
                int min_nest  &lt;-  (list_places min_of (each.nest)) ;
                list_places &lt;- list_places sort ((each.nest = min_nest) ? each.road :  0.0) ;
                return last(list_places) ;
            }
    }
    
    //Initial state of the ant : wander until it finds food or find a road to follow
    state wandering initial: true {
        do wander amplitude:120 ;
        transition to: carryingFood when: place.food &gt; 0 {
            do pick ;
        }
        transition to: followingRoad when: place.road &gt; 0.05 ;
    }
    //State to carry food to the nest once the food is found
    state carryingFood {
        do goto target: center ;
        transition to: wandering when: place.isNestLocation { 
            do drop ;
        }
    }
    //State to follow a road 
    state followingRoad {
        location &lt;- (self choose_best_place []) as point ;
        transition to: carryingFood when: place.food &gt; 0 {
            do pick ;
        }
        transition to: wandering when: (place.road &lt; 0.05) ;
    }
    aspect text {
        if use_icons {
            draw  hasFood ? file(ant_shape_full) : file(ant_shape_empty) rotate: heading at: location size: {7,5} ;
        } else {
            draw circle(1.0) empty: !hasFood color: rgb ('orange') ;
        }
        if display_state {
            draw state at: location + {-3,1.5} color: °white size: 0.8 ;
        }
    }
    aspect default {
        draw circle(1.0) empty: !hasFood color: #orange ; 
    }
}
experiment Ant type: gui {
    //Parameters to play with  in the gui
    parameter 'Number of ants:' var: ants_number category: 'Model' ;
    parameter 'Evaporation of the signal (unit/cycle):' var: evaporation_per_cycle category: 'Model' ;
    parameter 'Rate of diffusion of the signal (%/cycle):' var: diffusion_rate category: 'Model' ;
    parameter 'Use icons for the agents:' var: use_icons category: 'Display' ;
    parameter 'Display state of agents:' var: display_state category: 'Display' ;

    list&lt;list&lt;int&gt;&gt; nbants&lt;-[[0]];
    list&lt;string&gt; statesnames&lt;-["wandering"];
    list&lt;string&gt; categnames&lt;-["empty","carry"];
    list&lt;list&lt;int&gt;&gt; nbantsbydist&lt;-[[0]];
    list xytestvallist&lt;-[[[1,1],[2,2],[3,3]],[[1,2],[2,1],[3,4]],[[1,3],[2,3],[0,1]],[[1,4],[2,5],[0,0]]];
    list&lt;list&lt;int&gt;&gt; xyval&lt;-[[1,1],[2,1],[3,2]];

    //Reflex to update the charts, belonging to the experiment bloc as it will not be used by other experiment which don't have the charts
    reflex update_charts
    {
        nbants&lt;-list&lt;list&lt;int&gt;&gt;([]);
        statesnames&lt;-list&lt;string&gt;([]);
        categnames&lt;-["empty","carry"];
        nbantsbydist&lt;-list&lt;list&lt;int&gt;&gt;([]);
        ant x&lt;-one_of(world.ant);
        loop x over:list(world.ant)
        {
            if !(statesnames contains (x.state))
            {               
            add [(list(ant) count (each.state=x.state and !each.hasFood)),(list(ant) count (each.state=x.state and each.hasFood))] to: nbants;
            add (x.state) to:statesnames;               
            int d&lt;-0;
            list&lt;int&gt; nl&lt;-list&lt;int&gt;([]);
            loop d from:0 to:9
                {
            add (list(ant) count (each.state=x.state and (((each distance_to center)&gt;gridsize/20*d) and ((each distance_to center)&lt;gridsize/20*(d+1))))) to: nl;
                }
            add nl to:nbantsbydist;
            }
//          add length((list(world.ant) collect (each.next_place distance_to each.location)) where (each=x)) to:nbants;
        }
        //write("nbants"+nbants);
        //write("nbantsbydist"+nbantsbydist);
        //write("states"+statesnames);      
    }
    
    //The different displays
    output {
        display Ants type: opengl {
            grid ant_grid ;
            species ant aspect: text ;
        }
        display ProportionCarryFood {
            chart "Proportions carrying: Pie"  size: {0.5,0.5} position: {0, 0} type:pie
            {
                data "empty_ants" value:(list(ant) count (!each.hasFood)) color:°red;
                data "carry_food_ants" value:(list(ant) count (each.hasFood)) color:°green;
                
            }
            
            chart "Proportions carrying: Radar"  size: {0.5,0.5} position: {0.5, 0} type:radar
            axes:#white

            {
                data "empty" value:(list(ant) count (!each.hasFood)) 
                accumulate_values:true
                color:°red;             
                data "carry" value:(list(ant) count (each.hasFood)) 
                accumulate_values:true
                color:°blue;                
            }
            
            chart "Proportion: serie"   size: {1.0,0.5} position: {0, 0.5} type:series 
            series_label_position: legend
            style:stack
            {
                datalist ["empty","carry"] accumulate_values:true 
                value:[(list(ant) count (!each.hasFood)),(list(ant) count (each.hasFood))] 
                color:[°red,°green];                
            }
        }
// idem with stacked bar:
/* 
        display ProportionByState {
            chart "DataListListBar" type:histogram 
            x_serie_labels: categnames 
            series_label_position: legend
            {
                datalist value:nbants legend:statesnames style:stack;
            }
            
        }
*/
            // Idem with datalist:
//      display PositionByState {
//          chart "Position by state (datalist)" type:scatter
//          {
//              datalist ["empty","carry"] value:[((list(ant) where (!each.hasFood))  collect each.location),((list(ant) where (each.hasFood))  collect each.location)] color:[°red,°green] line_visible:false;             
//          }
//      }
        display CentroidPosition {
            chart "Positions and History of Centroide and size by Carry state" type:scatter
            {
                datalist ["avg-carry","avg-empty"] value:[mean((list(ant) where (each.hasFood)) collect each.location),
                    mean((list(ant) where (!each.hasFood)) collect each.location)
                ]
                marker_size: [length(list(ant) where (each.hasFood))/20,length(list(ant) where (!each.hasFood))/20]
                     color:[°red,°green] 
                     fill:false
                     line_visible:true;             
                data "empty_ants" value:((list(ant) where (!each.hasFood)) collect each.location) color:°red 
                accumulate_values:false
                line_visible:false;
                data "carry_food_ants" value:((list(ant) where (each.hasFood)) collect each.location) 
                accumulate_values:false
                color:°green line_visible:false;

            }
        }   
        display Distribution2dPosition {
            chart "Distribution of the X positions"   size: {0.65,0.3} position: {0.05, 0} type:histogram
            
            {
                datalist (distribution_of(list(ant) collect each.location.x,10,0,100) at "legend") 
                    value:(distribution_of(list(ant) collect each.location.x,10,0,100) at "values");
            }
            chart "Distribution of the Y positions"   size: {0.3,0.7} position: {0.7, 0.28} type:histogram
            reverse_axes:true
            
            {
                datalist reverse(distribution_of(list(ant) collect each.location.x,10,0,100) at "legend") 
                    value:reverse(distribution_of(list(ant) collect each.location.x,10,0,100) at "values");
            }

            chart "Distribution2d of the XvsY positions- heatmap"   size: {0.7,0.7} position: {0, 0.3} type:heatmap
            x_serie_labels: (distribution2d_of(list(ant) collect each.location.x,list(ant) collect each.location.y,10,0,100,10,0,100) at "legendx")
            y_serie_labels: (distribution2d_of(list(ant) collect each.location.x,list(ant) collect each.location.y,10,0,100,10,0,100) at "legendy")
            series_label_position:none
            {
                data  "XYdistrib"
                    value:(distribution2d_of(list(ant) collect each.location.x,list(ant) collect each.location.y,10,0,100,10,0,100) at "values")
                    color:[#red];
            }
        }
        
        display DistributionPosition {
            chart "Distribution of the X positions"   size: {0.92,0.3} position: {0, 0} type:histogram
            
            {
                datalist (distribution_of(list(ant) collect each.location.x,10,0,100) at "legend") 
                    value:(distribution_of(list(ant) collect each.location.x,10,0,100) at "values");
            }
            chart "Distribution of the X positions- heatmap"   size: {1.0,0.7} position: {0, 0.3} type:heatmap
            x_serie_labels: (distribution_of(list(ant) collect each.location.x,10,0,100) at "legend")
            y_range:50
            {
                data  "Xdistrib"
                    value:(distribution_of(list(ant) collect each.location.x,10,0,100) at "values")
                    color:[#red];
            }
        }   
        }
    
    }
    
//Experiment with only two display : the grid and the ants, and a chart
experiment AntOneDisp type: gui {
    parameter 'Number of ants:' var: ants_number category: 'Model' ;
    parameter 'Evaporation of the signal unit/cycle):' var: evaporation_per_cycle category: 'Model' ;
    parameter 'Rate of diffusion of the signal (%/cycle):' var: diffusion_rate category: 'Model' ;
    parameter 'Use icons for the agents:' var: use_icons category: 'Display' ;
    parameter 'Display state of agents:' var: display_state category: 'Display' ;

    list&lt;list&lt;int&gt;&gt; nbants&lt;-[[0]];
    list&lt;string&gt; statesnames&lt;-[""];
    list&lt;string&gt; categnames&lt;-["empty","carry"];
    list&lt;list&lt;int&gt;&gt; nbantsbydist&lt;-[[0]];
    list xytestvallist&lt;-[[[1,1],[2,2],[3,3]],[[1,2],[2,1],[3,4]],[[1,3],[2,3],[0,1]],[[1,4],[2,5],[0,0]]];
    list&lt;list&lt;int&gt;&gt; xyval&lt;-[[1,1],[2,1],[3,2]];

    reflex update_charts
    {
        ant x&lt;-one_of(world.ant);
        nbants&lt;-list&lt;list&lt;int&gt;&gt;([]);
        statesnames&lt;-list&lt;string&gt;([]);
        loop x over:list(world.ant)
        {
            if !(statesnames contains (x.state))
            {               
            add [(list(ant) count (each.state=x.state and !each.hasFood)),(list(ant) count (each.state=x.state and each.hasFood))] to: nbants;
            add (x.state) to:statesnames;               
            int d&lt;-0;
            list&lt;int&gt; nl&lt;-list&lt;int&gt;([]);
            loop d from:0 to:9
                {
            add (list(ant) count (each.state=x.state and (((each distance_to center)&gt;gridsize/20*d) and ((each distance_to center)&lt;gridsize/20*(d+1))))) to: nl;
                }
            add nl to:nbantsbydist;
            }
        }
        write("nbants"+nbants);
        write("nbantsbydist"+nbantsbydist);
        write("states"+statesnames);        
    }
    output {
        display Ants type: opengl {
            grid ant_grid ;
            species ant aspect: text ;
        }

        display ChartScatter {
            chart "Distribution2d of the XvsY positions- heatmap"   size: {0.7,0.7} position: {0, 0.3} type:heatmap
            x_serie_labels: (distribution2d_of(list(ant) collect each.location.x,list(ant) collect each.location.y,10,0,100,10,0,100) at "legendx")
            y_serie_labels: (distribution2d_of(list(ant) collect each.location.x,list(ant) collect each.location.y,10,0,100,10,0,100) at "legendy")
            series_label_position:none
            {
                data  "XYdistrib"
                    value:(distribution2d_of(list(ant) collect each.location.x,list(ant) collect each.location.y,10,0,100,10,0,100) at "values")
                    color:[#red];
            }
            
            }
    }
}





</code></pre>
</span></div></article></div><div class="docs-prevnext"></div></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/BC2019-Gama-Site/" class="nav-home"><img src="/BC2019-Gama-Site/resources/images/general/GamaPlatform.png" alt="GAMA-Platform" width="66" height="58"/></a><div><h5>Docs</h5><a href="/BC2019-Gama-Site/docs/en/doc1.html">Getting Started (or other categories)</a><a href="/BC2019-Gama-Site/docs/en/doc2.html">Guides (or other categories)</a><a href="/BC2019-Gama-Site/docs/en/doc3.html">API Reference (or other categories)</a></div><div><h5>Community</h5><a href="/BC2019-Gama-Site/en/users.html">User Showcase</a><a href="http://stackoverflow.com/questions/tagged/" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://discordapp.com/">Project Chat</a><a href="https://twitter.com/" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="/BC2019-Gama-Site/blog">Blog</a><a href="https://github.com/">GitHub</a></div></section><section class="copyright">Copyright © 2019 GAMA-Platform</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '0f9f28b9ab9efae89810921a351753b5',
                indexName: 'github',
                inputSelector: '#search_input_react'
              });
            </script></body></html>
<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>GoldMinerModel_step3 · GAMA-Platform</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;h1&gt;&lt;a class=&quot;anchor&quot; aria-hidden=&quot;true&quot; id=&quot;3-social-relation&quot;&gt;&lt;/a&gt;&lt;a href=&quot;#3-social-relation&quot; aria-hidden=&quot;true&quot; class=&quot;hash-link&quot;&gt;&lt;svg class=&quot;hash-link-icon&quot; aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3. Social relation&lt;/h1&gt;
"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="GoldMinerModel_step3 · GAMA-Platform"/><meta property="og:type" content="website"/><meta property="og:url" content="https://roiarthurb.github.io/BC2019-Gama-Site/"/><meta property="og:description" content="&lt;h1&gt;&lt;a class=&quot;anchor&quot; aria-hidden=&quot;true&quot; id=&quot;3-social-relation&quot;&gt;&lt;/a&gt;&lt;a href=&quot;#3-social-relation&quot; aria-hidden=&quot;true&quot; class=&quot;hash-link&quot;&gt;&lt;svg class=&quot;hash-link-icon&quot; aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3. Social relation&lt;/h1&gt;
"/><meta property="og:image" content="https://roiarthurb.github.io/BC2019-Gama-Site/resources/images/general/GamaPlatform.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://roiarthurb.github.io/BC2019-Gama-Site/resources/images/general/GamaPlatform.png"/><link rel="shortcut icon" href="/BC2019-Gama-Site/resources/images/general/GamaPlatform.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://roiarthurb.github.io/BC2019-Gama-Site/blog/atom.xml" title="GAMA-Platform Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://roiarthurb.github.io/BC2019-Gama-Site/blog/feed.xml" title="GAMA-Platform Blog RSS Feed"/><link rel="stylesheet" href="/css/code-block-buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/BC2019-Gama-Site/js/code-block-buttons.js"></script><link rel="stylesheet" href="/BC2019-Gama-Site/css/main.css"/><script src="/BC2019-Gama-Site/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/BC2019-Gama-Site/"><img class="logo" src="/BC2019-Gama-Site/resources/images/general/GamaPlatform.png" alt="GAMA-Platform"/><h2 class="headerTitleWithLogo">GAMA-Platform</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a target="_self">Index</a></li><li class=""><a href="/BC2019-Gama-Site/docs/Home" target="_self">Docs</a></li><li class=""><a href="/BC2019-Gama-Site/help" target="_self">Help</a></li><li class=""><a href="/BC2019-Gama-Site/blog/" target="_self">Blog</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">GoldMinerModel_step3</h1></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="3-social-relation"></a><a href="#3-social-relation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. Social relation</h1>
<p>This third step consists in adding social relation between agents and the possibility to share information about the known gold mines.</p>
<h2><a class="anchor" aria-hidden="true" id="formulation"></a><a href="#formulation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Formulation</h2>
<ul>
<li>Definition of global predicates</li>
<li>Definition of the gold miner species</li>
<li>Definition of the gold miner perceptions with socialization</li>
<li>Definition of a new gold miner plan to share information</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="social-relation"></a><a href="#social-relation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Social relation</h2>
<p>The BDI architecture of GAMA allows to define explicit social relations between agents. Based on the work of <a href="http://www.jbe-platform.com/content/books/9789027299055">Svennevig</a>, a social link with another agent is defined as a tuple &lt;agent,liking, dominance, solidarity, familiarity, trust&gt; with the following elements:</p>
<ul>
<li>Agent: the agent concerned by the link, identified by its name.</li>
<li>Liking: a real value between -1 and 1 representing the degree of liking with the agent concerned by the link. A value of -1 indicates that the concerned agent is hated, a value of 1 indicates that the concerned agent is liked.</li>
<li>Dominance: a real value between -1 and 1 representing the degree of power exerted on the agent concerned by the link. A value of -1 indicates that the concerned agent is dominating, a value of 1 indicates that the concerned agent is dominated.– Solidarity: a real value between 0 and 1 representing the degree of solidarity with the agent concerned by the link. A value of 0 indicates no solidarity with the concerned agent, a value of 1 indicates a complete solidarity with the concerned agent.</li>
<li>Familiarity: a real value between 0 and 1 representing the degree of familiarity with the agent concerned by the link. A value of 0 indicates no familiarity with the concerned agent, a value of 1 indicates a complete familiarity with the concerned agent.</li>
<li>Trust : a real value between -1 and +1 representing the degree of trust with the agent concerned by th link. A value of -1 indicates a doubt about the agent concerned, a value of 1 indicates a complete trust with the concerned agent.</li>
</ul>
<p>With this definition, a social relation is not necessarily symmetric. For example, let’s take two agents, Alice and Bob, with a social link towards each other. The agent Bob may have a social link &lt;Alice,1,-0.5,0.6,0.8,-0.2&gt; (Bob likes Alice with a value of 1, he thinks he is dominated by Alice, he is solidary with Alice with a value of 0.6, he is familiar with Alice with a value of 0.8 and he doubts about her with a value 0.2) and Alice may have a social link &lt;Bob,-0.2,0.2,0.4,0.5,0.8&gt; (Alice dislikes Bob with a value of 0.2, she thinks she is dominating Bob, she is solidary with Bob with a value of 0.4, she is familiar with Bob with a value of 0.5 and she trusts Bob with a value of 0.5).</p>
<h2><a class="anchor" aria-hidden="true" id="model-definition"></a><a href="#model-definition" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Model Definition</h2>
<h3><a class="anchor" aria-hidden="true" id="predicates"></a><a href="#predicates" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>predicates</h3>
<p>We add a new global predicate called <em>share_information</em> that represents the information that the miner wants to share information.</p>
<pre><code class="hljs"><span class="hljs-built_in">global</span> {
    <span class="hljs-params">...</span>
    predicate share_information &lt;- new_predicate(<span class="hljs-string">"share information"</span>) ;
        <span class="hljs-params">...</span>
}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="perception"></a><a href="#perception" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>perception</h3>
<p>We add a new perceive statement for the miner agents. This perceive will allow to create a social relation with the miners that are located at a distance lower or equal to &quot;viewdist&quot; to the agent.
For each of these miner agents, the agents create a new social relation using the <em>socialize</em> statement with a liking value that depends on the color of the agents: more the agent are close, higher will be the liking value.</p>
<pre><code class="hljs">species miner skills: [moving] control:simple_bdi {
    ...
        <span class="hljs-attribute">perceive target</span>:miner in:viewdist {
        socialize liking: 1 -  point(mycolor<span class="hljs-variable">.red</span>, mycolor<span class="hljs-variable">.green</span>, mycolor<span class="hljs-variable">.blue</span>) distance_to point(myself<span class="hljs-variable">.mycolor</span><span class="hljs-variable">.red</span>, myself<span class="hljs-variable">.mycolor</span><span class="hljs-variable">.green</span>, myself<span class="hljs-variable">.mycolor</span><span class="hljs-variable">.blue</span>) / ( 255);
    }
}
</code></pre>
<p>We also modify the perceive statement previously defined in order to add the desire to share information with a strength of 5 if the agent finds a gold mine.</p>
<pre><code class="hljs"><span class="hljs-selector-tag">species</span> <span class="hljs-selector-tag">miner</span> <span class="hljs-selector-tag">skills</span>: <span class="hljs-selector-attr">[moving]</span> <span class="hljs-selector-tag">control</span><span class="hljs-selector-pseudo">:simple_bdi</span> {
    ...
    <span class="hljs-selector-tag">perceive</span> <span class="hljs-selector-tag">target</span><span class="hljs-selector-pseudo">:goldmine</span> <span class="hljs-selector-tag">where</span> (each.quantity &gt; <span class="hljs-number">0</span>) <span class="hljs-selector-tag">in</span><span class="hljs-selector-pseudo">:viewdist</span> {
        <span class="hljs-selector-tag">focus</span> <span class="hljs-selector-tag">mine_at_location</span> <span class="hljs-selector-tag">var</span><span class="hljs-selector-pseudo">:location</span>;
        <span class="hljs-selector-tag">ask</span> <span class="hljs-selector-tag">myself</span> {
            <span class="hljs-selector-tag">do</span> <span class="hljs-selector-tag">add_desire</span>(<span class="hljs-attribute">predicate</span>:share_information, <span class="hljs-attribute">strength</span>: <span class="hljs-number">5.0</span>);
            <span class="hljs-selector-tag">do</span> <span class="hljs-selector-tag">remove_intention</span>(find_gold, false);
        }
    }
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="plan"></a><a href="#plan" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>plan</h3>
<p>At last, we add a new plan for the miner agents called <em>share_information_to_friends</em> to achieve the intention <em>share_information</em> that is instantaneous.
In this plan, the miner agent first defines its list of friends, i.e. the miners with which it has a social link and that it likes (linking higher than 0). then for each friend, it share its list of known mines (beliefs about their location), then its knowledge about the mines that are empty (beliefs about their location). At last, it removes the desire and intention to <em>share_information</em>.</p>
<pre><code class="hljs">species miner skills: <span class="hljs-literal">[<span class="hljs-identifier">moving</span>]</span> control:simple_bdi {<span class="hljs-operator">
    ...
    </span>plan share_information_to_friends intention: share_information instantaneous: <span class="hljs-literal">true</span>{
        <span class="hljs-built_in">list</span>&lt;miner&gt; my_friends &lt;- <span class="hljs-built_in">list</span>&lt;miner&gt;((social_link_base where (each.liking &gt; <span class="hljs-number">0</span>)) collect each.agent);
        loop known_goldmine over: get<span class="hljs-constructor">_beliefs_with_name(<span class="hljs-params">mine_at_location</span>)</span> {
            ask my_friends {
                <span class="hljs-keyword">do</span> add<span class="hljs-constructor">_belief(<span class="hljs-params">known_goldmine</span>)</span>;
            }
        }
        loop known_empty_goldmine over: get<span class="hljs-constructor">_beliefs_with_name(<span class="hljs-params">empty_mine_location</span>)</span> {
            ask my_friends {
                <span class="hljs-keyword">do</span> add<span class="hljs-constructor">_belief(<span class="hljs-params">known_empty_goldmine</span>)</span>;
            }
        }
        
        <span class="hljs-keyword">do</span> remove<span class="hljs-constructor">_intention(<span class="hljs-params">share_information</span>, <span class="hljs-params">true</span>)</span>; 
    }
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="complete-model"></a><a href="#complete-model" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Complete Model</h2>
<pre><code class="hljs">model GoldBdi

global {
    <span class="hljs-built_in">int</span> nb_mines &lt;- <span class="hljs-number">10</span>; 
    <span class="hljs-built_in">int</span> nbminer&lt;-<span class="hljs-number">5</span>;
    market the_market;
    
    <span class="hljs-built_in">string</span> mine_at_location &lt;- <span class="hljs-string">"mine_at_location"</span>;
    <span class="hljs-built_in">string</span> empty_mine_location &lt;- <span class="hljs-string">"empty_mine_location"</span>;
    
    <span class="hljs-built_in">float</span> step &lt;- <span class="hljs-number">10</span>#mn;
    
    <span class="hljs-comment">//possible predicates concerning miners</span>
    predicate mine_location &lt;- <span class="hljs-keyword">new</span><span class="hljs-constructor">_predicate(<span class="hljs-params">mine_at_location</span>)</span> ;
    predicate choose_goldmine &lt;- <span class="hljs-keyword">new</span><span class="hljs-constructor">_predicate(<span class="hljs-string">"choose a gold mine"</span>)</span>;
    predicate has_gold &lt;- <span class="hljs-keyword">new</span><span class="hljs-constructor">_predicate(<span class="hljs-string">"extract gold"</span>)</span>;
    predicate find_gold &lt;- <span class="hljs-keyword">new</span><span class="hljs-constructor">_predicate(<span class="hljs-string">"find gold"</span>)</span> ;
    predicate sell_gold &lt;- <span class="hljs-keyword">new</span><span class="hljs-constructor">_predicate(<span class="hljs-string">"sell gold"</span>)</span> ;
    predicate share_information &lt;- <span class="hljs-keyword">new</span><span class="hljs-constructor">_predicate(<span class="hljs-string">"share information"</span>)</span> ;
    
    <span class="hljs-built_in">float</span> inequality &lt;- <span class="hljs-number">0.0</span> update:standard<span class="hljs-constructor">_deviation(<span class="hljs-params">miner</span> <span class="hljs-params">collect</span> <span class="hljs-params">each</span>.<span class="hljs-params">gold_sold</span>)</span>;
    
    geometry shape &lt;- square(<span class="hljs-number">20</span> #km);
    init
    {
        create market {
            the_market &lt;- self; 
        }
        create goldmine number:nb_mines;
        create miner number:nbminer;
    }
    
    reflex end_simulation <span class="hljs-keyword">when</span>: sum(goldmine collect each.quantity) = <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> empty(miner where each.has<span class="hljs-constructor">_belief(<span class="hljs-params">has_gold</span>)</span>){
        <span class="hljs-keyword">do</span> pause;
    }
}

species goldmine {
    <span class="hljs-built_in">int</span> quantity &lt;- rnd(<span class="hljs-number">1</span>,<span class="hljs-number">20</span>);
    aspect default
    {
        <span class="hljs-keyword">if</span> (quantity = <span class="hljs-number">0</span>) {
            draw triangle(<span class="hljs-number">200</span>) color: #gray border: #black; 
        } <span class="hljs-keyword">else</span> {
            draw triangle(<span class="hljs-number">200</span> + quantity*<span class="hljs-number">50</span>) color: #yellow border: #black; 
        }
     
    }
}

species market {
    <span class="hljs-built_in">int</span> golds;
    aspect default
    {
      draw square(<span class="hljs-number">1000</span>) color: #black ;
    }
}

species miner skills: <span class="hljs-literal">[<span class="hljs-identifier">moving</span>]</span> control:simple_bdi {
    
    <span class="hljs-built_in">float</span> viewdist&lt;-<span class="hljs-number">1000.0</span>;
    <span class="hljs-built_in">float</span> speed &lt;- <span class="hljs-number">2</span>#km/#h;
    rgb mycolor&lt;-rnd<span class="hljs-constructor">_color(255)</span>;
    point target;
    <span class="hljs-built_in">int</span> gold_sold;

        <span class="hljs-built_in">bool</span> use_social_architecture &lt;- <span class="hljs-literal">true</span>;
    
    init
    {
        <span class="hljs-keyword">do</span> add<span class="hljs-constructor">_desire(<span class="hljs-params">find_gold</span>)</span>;
    }
    
    perceive target:miner <span class="hljs-keyword">in</span>:viewdist {
        socialize liking: <span class="hljs-number">1</span> -  point(mycolor.red, mycolor.green, mycolor.blue) distance_to point(myself.mycolor.red, myself.mycolor.green, myself.mycolor.blue)<span class="hljs-operator"> / </span>( <span class="hljs-number">255</span>);
    }
        
    perceive target:goldmine where (each.quantity &gt; <span class="hljs-number">0</span>) <span class="hljs-keyword">in</span>:viewdist {
        focus id: mine_at_location var:location;
        ask myself {
            <span class="hljs-keyword">do</span> add<span class="hljs-constructor">_desire(<span class="hljs-params">predicate</span>:<span class="hljs-params">share_information</span>, <span class="hljs-params">strength</span>: 5.0)</span>;
            <span class="hljs-keyword">do</span> remove<span class="hljs-constructor">_intention(<span class="hljs-params">find_gold</span>, <span class="hljs-params">false</span>)</span>;
        }
    }
    
    rule belief: mine_location new_desire: has_gold strength: <span class="hljs-number">2.0</span>;
    rule belief: has_gold new_desire: sell_gold strength: <span class="hljs-number">3.0</span>;
    
        
    plan letsWander intention:find_gold 
    {
        <span class="hljs-keyword">do</span> wander;
    }
    
    plan getGold intention:has_gold 
    {
        <span class="hljs-keyword">if</span> (target = nil) {
            <span class="hljs-keyword">do</span> add<span class="hljs-constructor">_subintention(<span class="hljs-params">has_gold</span>,<span class="hljs-params">choose_goldmine</span>, <span class="hljs-params">true</span>)</span>;
            <span class="hljs-keyword">do</span> current<span class="hljs-constructor">_intention_on_hold()</span>;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">do</span> goto target: target ;
            <span class="hljs-keyword">if</span> (target = location)  {
                goldmine current_mine&lt;- goldmine first_with (target = each.location);
                <span class="hljs-keyword">if</span> current_mine.quantity &gt; <span class="hljs-number">0</span> {
                    <span class="hljs-keyword">do</span> add<span class="hljs-constructor">_belief(<span class="hljs-params">has_gold</span>)</span>;
                    ask current_mine {quantity &lt;- quantity - <span class="hljs-number">1</span>;}    
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-keyword">do</span> add<span class="hljs-constructor">_belief(<span class="hljs-params">new_predicate</span>(<span class="hljs-params">empty_mine_location</span>, [<span class="hljs-string">"location_value"</span>::<span class="hljs-params">target</span>])</span>);
                }
                target &lt;- nil;
            }
        }   
    }
    
    plan choose_closest_goldmine intention: choose_goldmine instantaneous: <span class="hljs-literal">true</span>{
        <span class="hljs-built_in">list</span>&lt;point&gt; possible_mines &lt;- get<span class="hljs-constructor">_beliefs_with_name(<span class="hljs-params">mine_at_location</span>)</span> collect (point(get<span class="hljs-constructor">_predicate(<span class="hljs-params">mental_state</span> (<span class="hljs-params">each</span>)</span>).values<span class="hljs-literal">["<span class="hljs-identifier">location_value</span>"]</span>));
        <span class="hljs-built_in">list</span>&lt;point&gt; empty_mines &lt;- get<span class="hljs-constructor">_beliefs_with_name(<span class="hljs-params">empty_mine_location</span>)</span> collect (point(get<span class="hljs-constructor">_predicate(<span class="hljs-params">mental_state</span> (<span class="hljs-params">each</span>)</span>).values<span class="hljs-literal">["<span class="hljs-identifier">location_value</span>"]</span>));
        possible_mines &lt;- possible_mines - empty_mines;
        <span class="hljs-keyword">if</span> (empty(possible_mines)) {
            <span class="hljs-keyword">do</span> remove<span class="hljs-constructor">_intention(<span class="hljs-params">has_gold</span>, <span class="hljs-params">true</span>)</span>; 
        } <span class="hljs-keyword">else</span> {
            target &lt;- (possible_mines with_min_of (each distance_to self)).location;
        }
        <span class="hljs-keyword">do</span> remove<span class="hljs-constructor">_intention(<span class="hljs-params">choose_goldmine</span>, <span class="hljs-params">true</span>)</span>; 
    }
    
    plan return_to_base intention: sell_gold {
        <span class="hljs-keyword">do</span> goto target: the_market ;
        <span class="hljs-keyword">if</span> (the_market.location = location)  {
            <span class="hljs-keyword">do</span> remove<span class="hljs-constructor">_belief(<span class="hljs-params">has_gold</span>)</span>;
            <span class="hljs-keyword">do</span> remove<span class="hljs-constructor">_intention(<span class="hljs-params">sell_gold</span>, <span class="hljs-params">true</span>)</span>;
            gold_sold &lt;- gold_sold + <span class="hljs-number">1</span>;
        }
    }
    plan share_information_to_friends intention: share_information instantaneous: <span class="hljs-literal">true</span>{
        <span class="hljs-built_in">list</span>&lt;miner&gt; my_friends &lt;- <span class="hljs-built_in">list</span>&lt;miner&gt;((social_link_base where (each.liking &gt; <span class="hljs-number">0</span>)) collect each.agent);
        loop known_goldmine over: get<span class="hljs-constructor">_beliefs_with_name(<span class="hljs-params">mine_at_location</span>)</span> {
            ask my_friends {
                <span class="hljs-keyword">do</span> add<span class="hljs-constructor">_belief(<span class="hljs-params">known_goldmine</span>)</span>;
            }
        }
        loop known_empty_goldmine over: get<span class="hljs-constructor">_beliefs_with_name(<span class="hljs-params">empty_mine_location</span>)</span> {
            ask my_friends {
                <span class="hljs-keyword">do</span> add<span class="hljs-constructor">_belief(<span class="hljs-params">known_empty_goldmine</span>)</span>;
            }
        }
        
        <span class="hljs-keyword">do</span> remove<span class="hljs-constructor">_intention(<span class="hljs-params">share_information</span>, <span class="hljs-params">true</span>)</span>; 
    }

    aspect default {
      draw circle(<span class="hljs-number">200</span>) color: mycolor border: #black depth: gold_sold;
    }
}


experiment GoldBdi <span class="hljs-keyword">type</span>: gui {
    output {
        display map <span class="hljs-keyword">type</span>: opengl
        {
            species market ;
            species goldmine ;
            species miner;
        }
    }
}
</code></pre>
<p><a href="BDIAgents">Back to the start of the tutorial</a></p>
<ol>
<li><a href="GoldMinerModel_step1">Creation of the basic model: gold mines and market</a></li>
<li><a href="GoldMinerModel_step2">Definition of the BDI miners</a></li>
<li><a href="GoldMinerModel_step4">Use of emotions and personality for the miners</a></li>
<li><a href="GoldMinerModel_step5">Adding norms, obligations and enforcement</a></li>
</ol>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#formulation">Formulation</a></li><li><a href="#social-relation">Social relation</a></li><li><a href="#model-definition">Model Definition</a><ul class="toc-headings"><li><a href="#predicates">predicates</a></li><li><a href="#perception">perception</a></li><li><a href="#plan">plan</a></li></ul></li><li><a href="#complete-model">Complete Model</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/BC2019-Gama-Site/" class="nav-home"><img src="/BC2019-Gama-Site/resources/images/general/GamaPlatform.png" alt="GAMA-Platform" width="66" height="58"/></a><div><h5>Docs</h5><a href="/BC2019-Gama-Site/docs/en/doc1.html">Getting Started (or other categories)</a><a href="/BC2019-Gama-Site/docs/en/doc2.html">Guides (or other categories)</a><a href="/BC2019-Gama-Site/docs/en/doc3.html">API Reference (or other categories)</a></div><div><h5>Community</h5><a href="/BC2019-Gama-Site/en/users.html">User Showcase</a><a href="http://stackoverflow.com/questions/tagged/" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://discordapp.com/">Project Chat</a><a href="https://twitter.com/" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="/BC2019-Gama-Site/blog">Blog</a><a href="https://github.com/">GitHub</a></div></section><section class="copyright">Copyright © 2019 GAMA-Platform</section></footer></div></body></html>
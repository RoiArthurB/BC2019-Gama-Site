<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Ant Foraging (Complex) · GAMA-Platform</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="GAMA"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Ant Foraging (Complex) · GAMA-Platform"/><meta property="og:type" content="website"/><meta property="og:url" content="https://roiarthurb.github.io/BC2019-Gama-Site/"/><meta property="og:description" content="GAMA"/><meta property="og:image" content="https://roiarthurb.github.io/BC2019-Gama-Site//resources/images/general/GamaPlatform.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://roiarthurb.github.io/BC2019-Gama-Site//resources/images/general/GamaPlatform.png"/><link rel="shortcut icon" href="/BC2019-Gama-Site//img/gama-logo.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="stylesheet" href="/BC2019-Gama-Site/css/code-block-buttons.css"/><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css"/><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.4.4/fuse.min.js"></script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/BC2019-Gama-Site/js/code-block-buttons.js"></script><script type="text/javascript" src="/BC2019-Gama-Site/js/searchEngine.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><link rel="stylesheet" href="/BC2019-Gama-Site/css/main.css"/><script src="/BC2019-Gama-Site/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/BC2019-Gama-Site/"><img class="logo" src="/BC2019-Gama-Site//img/gama-logo_white.png" alt="GAMA-Platform"/><h2 class="headerTitleWithLogo">GAMA-Platform</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/BC2019-Gama-Site/wiki/Home" target="_self">Documentation</a></li><li class=""><a href="/BC2019-Gama-Site/wiki/Tutorials" target="_self">Tutorials</a></li><li class=""><a href="/BC2019-Gama-Site/download" target="_self">Download</a></li><li class=""><a href="/BC2019-Gama-Site/wiki/Contribute" target="_self">Contribute</a></li><li class=""><a target="_self"></a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Ant Foraging (Complex)</h1></header><article><div><span><p>_Author : _</p>
<p>Toy Model ant using the question of how ants search food and use pheromons to return to their nest once they did find food. Two experiments are proposed to show how to use batch : Batch and Genetic.</p>
<p>Code of the model :</p>
<pre><code class="hljs">model ants

global {
    <span class="hljs-comment">//Evaporation value per cycle</span>
    float evaporation_per_cycle &lt;- 5.0 min: 0.0 max: 240.0 parameter: <span class="hljs-string">'Evaporation of the signal (unit/cycle):'</span> category: <span class="hljs-string">'Signals'</span>;
    <span class="hljs-comment">//Diffusion rate of the pheromon among the grid</span>
    float diffusion_rate &lt;- 1.0 min: 0.0 max: 1.0 parameter: <span class="hljs-string">'Rate of diffusion of the signal (%/cycle):'</span> category: <span class="hljs-string">'Signals'</span>;
    <span class="hljs-comment">//Size of the grid</span>
    int gridsize &lt;- 100 min: 30 parameter: <span class="hljs-string">'Width and Height of the grid:'</span> category: <span class="hljs-string">'Environment and Population'</span>;
    <span class="hljs-comment">//Number of ants</span>
    int ants_number &lt;- 200 min: 1 parameter: <span class="hljs-string">'Number of ants:'</span> category: <span class="hljs-string">'Environment and Population'</span>;
    <span class="hljs-comment">//Frequency of update of the grid</span>
    int grid_frequency &lt;- 1 min: 1 max: 100 parameter: <span class="hljs-string">'Grid updates itself every:'</span> category: <span class="hljs-string">'Environment and Population'</span>;
    <span class="hljs-comment">//Number of food places among the grid</span>
    int number_of_food_places &lt;- 5 min: 1 parameter: <span class="hljs-string">'Number of food depots:'</span> category: <span class="hljs-string">'Environment and Population'</span>;
    float grid_transparency &lt;- 1.0;
    file ant_shape_empty const: true &lt;- file(<span class="hljs-string">'../icons/ant.png'</span>);
    image_file ant_shape_full const: true &lt;- file(<span class="hljs-string">'../icons/full_ant.png'</span>);
    <span class="hljs-comment">//The center of the grid that will be considered as the nest location</span>
    point center const: true &lt;- { round(gridsize / 2), round(gridsize / 2) };
    int food_gathered &lt;- 1;
    int food_placed &lt;- 1;
    rgb background const: true &lt;- rgb(#99CC66);
    rgb food_color const: true &lt;- rgb(#312200);
    rgb nest_color const: true &lt;- rgb(#000000); 

    geometry shape &lt;- square(gridsize);
    init {
        <span class="hljs-comment">//Creation of the food places placed randomly with a certain distance between each</span>
        loop times: number_of_food_places {
            point loc &lt;- { rnd(gridsize - 10) + 5, rnd(gridsize - 10) + 5 };
            list&lt;ant_grid&gt; food_places &lt;- (ant_grid where ((each distance_to loc) &lt; 5));
            ask food_places {
                if food = 0 {
                    food &lt;- 5;
                    food_placed &lt;- food_placed + 5;
                    color &lt;- food_color;  
                }                                           
            }
        }
        <span class="hljs-comment">//Creation of the ants that will be placed in the nest</span>
        create ant number: ants_number with: (location: center);
    }
    <span class="hljs-comment">//Reflex to diffuse the pheromon among the grid</span>
    reflex diffuse {
      diffuse var:road on:ant_grid proportion: diffusion_rate radius:3 propagation: gradient method:convolution;
   }
  
}

<span class="hljs-comment">//Grid used to discretize the space to place food</span>
grid ant_grid width: gridsize height: gridsize neighbors: 8 frequency: grid_frequency use_regular_agents: false use_individual_shapes: false{
    bool is_nest const: true &lt;- (topology(ant_grid) distance_between [self, center]) &lt; 4;
    float road &lt;- 0.0 max: 240.0 update: (road &lt;= evaporation_per_cycle) ? 0.0 : road - evaporation_per_cycle;
    rgb color &lt;- is_nest ? nest_color : ((food &gt; 0) ? food_color : ((road &lt; 0.001) ? background : rgb(#009900) + int(road * 5))) update: is_nest ? nest_color : ((food &gt; 0) ?
    food_color : ((road &lt; 0.001) ? background : rgb(#009900) + int(road * 5)));
    int food &lt;- 0;
}
<span class="hljs-comment">//Species ant that will move and follow a final state machine</span>
species ant skills: [moving] control: fsm {
    float speed &lt;- 1.0;
    bool has_food &lt;- false;
    
    <span class="hljs-comment">//Reflex to place a pheromon stock in the cell</span>
    reflex diffuse_road when:has_food=true{
      ant_grid(location).road &lt;- ant_grid(location).road + 100.0;
   }
    <span class="hljs-comment">//Action to pick food</span>
    action pick (int amount) {
        has_food &lt;- true;
        ant_grid place &lt;- ant_grid(location);
        place.food &lt;- place.food - amount;
    }
    <span class="hljs-comment">//Action to drop food</span>
    action drop {
        food_gathered &lt;- food_gathered + 1;
        has_food &lt;- false;
        heading &lt;- heading - 180;
    }
    <span class="hljs-comment">//Action to find the best place in the neighborhood cells</span>
    point choose_best_place {
        container list_places &lt;- ant_grid(location).neighbors;
        if (list_places count (each.food &gt; 0)) &gt; 0 {
            return point(list_places first_with (each.food &gt; 0));
        } else {
            list_places &lt;- (list_places where ((each.road &gt; 0) and ((each distance_to center) &gt; (self distance_to center)))) sort_by (each.road);
            return point(last(list_places));
        }

    }
    <span class="hljs-comment">//Reflex to drop food once the ant is in the nest</span>
    reflex drop when: has_food and (ant_grid(location)).is_nest {
        do drop();
    }
    <span class="hljs-comment">//Reflex to pick food when there is one at the same location</span>
    reflex pick when: !has_food and (ant_grid(location)).food &gt; 0 {
        do pick(1);
    }
    <span class="hljs-comment">//Initial state to make the ant wander </span>
    state wandering initial: true {
        do wander(amplitude: 90);
        float pr &lt;- (ant_grid(location)).road;
        transition to: carryingFood when: has_food;
        transition to: followingRoad when: (pr &gt; 0.05) and (pr &lt; 4);
    }
    <span class="hljs-comment">//State to carry food once it has been found</span>
    state carryingFood {
        do goto(target: center);
        transition to: wandering when: !has_food;
    }
    <span class="hljs-comment">//State to follow a pheromon road if once has been found</span>
    state followingRoad {
        point next_place &lt;- choose_best_place();
        float pr &lt;- (ant_grid(location)).road;
        location &lt;- next_place;
        transition to: carryingFood when: has_food;
        transition to: wandering when: (pr &lt; 0.05) or (next_place = <span class="hljs-literal">nil</span>);
    }

    aspect info {
        draw circle(1) empty: !has_food color: #red;
        if (destination != <span class="hljs-literal">nil</span>) {
            draw line([location + {0,0,0.5}, destination + {0,0,0.5}]) + 0.1 color: #white border: false;
        }

        draw circle(4) empty: true color: #white;
        draw string(self as int) color: #white font: font(<span class="hljs-string">"Helvetica"</span>, 12 * #zoom, #bold) at: my location - {1, 1, -0.5};
        draw state color: #yellow  font: font(<span class="hljs-string">"Helvetica"</span>, 10 * #zoom, #plain) at: my location + { 1, 1, 0.5 } perspective: false;
    }

    aspect icon {
        draw ant_shape_empty size: {7,5} rotate: my heading + 1;
    }

    aspect default {
        draw square(1) empty: !has_food color: #blue rotate: my heading;
    }
}   
<span class="hljs-comment">//Simple experiment to display the ants</span>
experiment Displays type: gui {
    point quadrant_size &lt;- { 0.5, 0.5 };
    float inc &lt;- 0.001;
    float pos &lt;- 0.0;
    reflex moving_quadrant {
    <span class="hljs-comment">//pos &lt;- pos + inc;</span>
        if (pos &gt; 0.5 or pos &lt;= 0) {
            inc &lt;- -inc;
        }
        
    }

    output {
        display Ants background: #white type: opengl {
            image <span class="hljs-string">'../images/soil.jpg'</span> position: { pos, pos } size: quadrant_size;
            agents <span class="hljs-string">"agents"</span> transparency: 0.5 position: { pos, pos } size: quadrant_size value: (ant_grid as list) where ((each.food &gt; 0) or (each.road &gt; 0) or (each.is_nest));
            species ant position: { pos, pos } size: quadrant_size aspect: icon;
            grid ant_grid lines: #darkgray position: { 0.5, 0 } size: quadrant_size;
            species ant position: { 0.5, 0 } size: quadrant_size aspect: info;
        }
    }
}
<span class="hljs-comment">//Complete experiment that will inspect all ants in a table</span>
experiment Complete type: gui {
    parameter <span class="hljs-string">'Number:'</span> var: ants_number init: 100 unit: <span class="hljs-string">'ants'</span> category: <span class="hljs-string">'Environment and Population'</span>;
    parameter <span class="hljs-string">'Grid dimension:'</span> var: gridsize init: 100 unit: <span class="hljs-string">'(number of rows and columns)'</span> category: <span class="hljs-string">'Environment and Population'</span>;
    parameter <span class="hljs-string">'Number of food depots:'</span> var: number_of_food_places init: 5 min: 1 category: <span class="hljs-string">'Environment and Population'</span>;

    <span class="hljs-comment">// Experimentator</span>

    init {
        <span class="hljs-statement">write</span> <span class="hljs-string">"Experimentator agent running "</span> + self;
       ants_number &lt;- 200;
    }


    output {
        display Ants2D type: java2D {
            image <span class="hljs-string">'../images/soil.jpg'</span> position: { 0.05, 0.05 } size: { 0.9, 0.9 };
            agents <span class="hljs-string">"agents"</span> transparency: 0.7 position: { 0.05, 0.05 } size: { 0.9, 0.9 } value: (ant_grid as list) where ((each.food &gt; 0) or (each.road &gt; 0) or (each.is_nest)) ;
            species ant position: { 0.05, 0.05 } size: { 0.9, 0.9 } aspect: icon;
            overlay <span class="hljs-string">"Texts"</span> transparency: 0.3 background: rgb (99, 85, 66,255)  position: {10°px, 10°px} size: {250°px, 150°px} border: rgb (99, 85, 66,255) rounded: true{
                draw ant_shape_full at: {60°px, 70°px} size: {140°px, 100°px} rotate: -60;
                draw (<span class="hljs-string">'Food foraged: '</span> + (((food_placed = 0 ? 0 : food_gathered / food_placed) * 100) with_precision 2) + <span class="hljs-string">'%'</span>) at: {40°px,70°px} font:font(<span class="hljs-string">"Arial"</span>, 18, #bold) color: #white;
                draw (<span class="hljs-string">'Carrying ants: '</span> + (((100 * ant count (each.has_food or each.state = <span class="hljs-string">"followingRoad"</span>)) / length(ant)) with_precision 2) + <span class="hljs-string">'%'</span>) at: {40°px, 100°px} font:font(<span class="hljs-string">"Arial"</span>, 18 , #bold) color: #white;
            }
                    
        }
        inspect <span class="hljs-string">"All ants"</span> type: table value: ant attributes: [<span class="hljs-string">'name'</span>, <span class="hljs-string">'location'</span>, <span class="hljs-string">'heading'</span>,<span class="hljs-string">'state'</span>];
    }
}
<span class="hljs-comment">//Batch experiment to find the best way to maximize the food gathered using exhaustive method</span>
experiment Batch type: batch repeat: 4 keep_seed: true until: (food_gathered = food_placed) or (time &gt; 1000) {
    parameter <span class="hljs-string">'Size of the grid:'</span> var: gridsize init: 75 unit: <span class="hljs-string">'width and height'</span>;
    parameter <span class="hljs-string">'Number:'</span> var: ants_number among:[10,20,50] unit: <span class="hljs-string">'ants'</span>;
    parameter  <span class="hljs-string">'Evaporation:'</span> var: evaporation_per_cycle among: [0.1, 0.5, 2.0, 10.0] unit: <span class="hljs-string">'units every cycle'</span>;
    parameter  <span class="hljs-string">'Diffusion:'</span> var: diffusion_rate min: 0.1 max: 1.0 unit: <span class="hljs-string">'rate every cycle (1.0 means 100%)'</span> step: 0.2;
    method exhaustive maximize: food_gathered;

    
    permanent {
        display Comparison background: #white {
            chart <span class="hljs-string">"Food Gathered"</span> type: series {
                    data <span class="hljs-string">"Min"</span> value:  min(ants_model collect each.food_gathered ) style: spline color: #darkgreen ;
                    data <span class="hljs-string">"Max"</span> value:  max(ants_model collect each.food_gathered ) style: spline color: #red ;
            }
        }
    }
}

<span class="hljs-comment">//Batch experiment to find the best way to maximize the food gathered using genetic method</span>
experiment Genetic type: batch repeat: 2 keep_seed: true until: (food_gathered = food_placed) or (time &gt; 1000) {
    parameter <span class="hljs-string">'Size of the grid:'</span> var: gridsize init: 75 unit: <span class="hljs-string">'(width and height)'</span>;
    parameter <span class="hljs-string">'Number:'</span> var: ants_number among:[10,20,50] unit: <span class="hljs-string">'ants'</span>;
    parameter  <span class="hljs-string">'Evaporation:'</span> var: evaporation_per_cycle among: [0.1, 0.5, 2.0, 10.0] unit: <span class="hljs-string">'units every cycle'</span>;
    parameter <span class="hljs-string">'Diffusion:'</span> var: diffusion_rate min: 0.1 max: 1.0 unit: <span class="hljs-string">'rate every cycle (1.0 means 100%)'</span> step: 0.2;
    method genetic maximize: food_gathered pop_dim: 5 crossover_prob: 0.7 mutation_prob: 0.1 nb_prelim_gen: 1 max_gen: 20;
    
        permanent {
        display Comparison background: #white {
            chart <span class="hljs-string">"Food Gathered"</span> type: series {
                    data <span class="hljs-string">"Min"</span> value:  min(ants_model collect each.food_gathered ) style: spline color: #darkgreen ;
                    data <span class="hljs-string">"Max"</span> value:  max(ants_model collect each.food_gathered ) style: spline color: #red ;
            }
        }
    }
}

</code></pre>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/BC2019-Gama-Site/" class="nav-home"><img src="/BC2019-Gama-Site//img/gama-logo.png" alt="GAMA-Platform" width="66" height="58"/></a><div><h5>Networks</h5><a href="https://www.youtube.com/channel/UCWJ1kWGDDI-9u2f2uD0gcaQ" target="_blank"><i class="fab fa-youtube"></i> Youtube</a><a href="https://www.linkedin.com/company/gama-platform" target="_blank"><i class="fab fa-linkedin"></i> LinkedIn</a><a href="https://twitter.com/gamaplatform" target="_blank"><i class="fab fa-twitter"></i> Twitter</a><a href="https://www.facebook.com/GamaPlatform/" target="_blank"><i class="fab fa-facebook"></i> Facebook</a></div><div><h5>Mailing list</h5><a href="https://groups.google.com/forum/#!forum/gama-platform" target="_blank"><i class="fas fa-envelope"></i> For Users<br/>gama-platform@googlegroups.com</a><a href="https://groups.google.com/forum/#!forum/gama-dev" target="_blank"><i class="fas fa-envelope"></i> For Developers<br/>gama-dev@googlegroups.com</a></div><div><h5>Ecosystem</h5><a href="https://github.com/gama-platform/gama"><i class="fab fa-github"></i> GitHub Gama</a><a href="https://github.com/gama-platform/gama.experimental"><i class="fas fa-puzzle-piece"></i> Gama Experimental Plugins</a><a href="https://github.com/gama-platform/gama.models.experimental"><i class="fas fa-scroll"></i> Gama Experimental Models</a></div></section><section class="copyright">Copyright © 2019 GAMA-Platform</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '0f9f28b9ab9efae89810921a351753b5',
                indexName: 'github',
                inputSelector: '#search_input_react'
              });
            </script></body></html>